/**
 * Copyright (c) 2018-present, A2 Re≈°itve d.o.o.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in
 * compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License is
 * distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See
 * the License for the specific language governing permissions and limitations under the License.
 */

package solutions.a2.cdc.oracle.internals;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertFalse;
import static org.junit.jupiter.api.Assertions.assertTrue;
import static solutions.a2.cdc.oracle.OraCdcV$LogmnrContents.UPDATE;
import static solutions.a2.cdc.oracle.internals.OraCdcChange._11_5_URP;
import static solutions.a2.cdc.oracle.internals.OraCdcChange._11_16_LMN;
import static solutions.a2.oracle.utils.BinaryUtils.hexToRaw;

import java.io.IOException;

import org.junit.jupiter.api.Test;

import solutions.a2.cdc.oracle.OraCdcRedoMinerStatement;
import solutions.a2.cdc.oracle.OraCdcTransaction;
import solutions.a2.cdc.oracle.OraCdcTransactionArrayList;

/**
 *  
 * @author <a href="mailto:averemee@a2.solutions">Aleksei Veremeev</a>
 * 
 */
public class Ops_URP_LMN_BindingLifoTest extends TestWithOutput {



	@Test
	public void testOeOrderLinesAll() {

		OraCdcRedoLog orl = OraCdcRedoLog.getLinux19c();
		
		byte[] baUpdate1 = hexToRaw("6006000001008D053336FFD90100000007D7CD51000070880501BC005600FFFF4CD984152836FFD98D0500000100FFFF0300000000000000E2001400180010002900CC0005000300020009000700070000000200030002000100000003000000000000000000010000000000030003000300000000000000000000000000020004000A0001000100000000000000000000000000000000000000050007000000000000000000030007000200000000001C000B0007000A00000003000300000000000A00000003000000000000000000000003000300010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001C00040004000500020000001C03301322000000560019008E7533004F622245DBA70200DBA702000E000000000000000B01192100008E75020D0000000000004BD984154F620D00ABFA8D1732D4C4087D092501010000002801470003006866F8FF40E88D1FFCE731647DFCFFFF3F00000D0000020003000400050006000700080009000A000B000C000D000E000F0010001100120013001400150016001700180019001A001B001C001D001E001F0020002100220023002400250026002700280029002A002B002C002D002E002F0030003100320033003400350036003700380039003A003B003C003D003E003F0040004100420043004400450046004700480049004A004B004C004D004E004F0050005100520053005400550056005700580059005A005B005C005D005E005F0060006100620063006400650066006700C411214C2F000000C20B0200C1030200353635313036323537000400787D0C0501010100787D0C050101010045410200C21055084541FED980050000C21055A053000000C2033E00C2452D00C2422A00C1540000C3072948343238333334353133383D008091C4088091C408C4023C5E15000000787D0C0501010101C23D0600787D0B1D09242588C10201003030303030315F554E53504543494649455F4C5F5354414E44415244554E535045434946494544D9434F4C4C454354FF5348495020504F494E541400C20D16003E63660034323833333435313338000030303200C1020600C102060080A00200010802002E000300030000000010000000000000ABFA8D17030000000100020005000200C41B11455B91C408C15425010B0501005E000200ABFA8D17D734FFD98D0500000200DBA70300000000000000D40010002900CC0005000300020009000700070007000200030002000100000003000000000000000100010000000000030003000300000000000000000000000000020004000A0001000100000000000000000000000000000000000000050007000000000000000000030007000200000000001C000B0007000A00000003000300000000000A0000000300000000000000000000000300030001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020D0000000000004CD984154F622200ABFA8D1732D4C4087D090501010000002801470003006866080000E88C1FFCE731647DFCFFFF3F0000000B01020003000400050006000700080009000A000B000C000D000E000F0010001100120013001400150016001700180019001A001B001C001D001E001F0020002100220023002400250026002700280029002A002B002C002D002E002F0030003100320033003400350036003700380039003A003B003C003D003E003F0040004100420043004400450046004700480049004A004B004C004D004E004F0050005100520053005400550056005700580059005A005B005C005D005E005F0060006100620063006400650066006700C411214C2F00CC02C20B0200C1030400353635313036323537A00200787D0C0501010100787D0C050101013F787D0C05183C010045410000C210551545413F008091C408C21055088009250153000000C2033E00C2452D01C2422A00C154FED9C30729483432383333343531333804008000000080100000C4023C5E15050100787D0C05183C0108C23D06D9787D0B1D092425A0C10200003030303030315F554E53504543494649455F4C5F5354414E44415244554E53504543494649454408434F4C4C454354005348495020504F494E540000C20D16003E636600343238333334353133388D05303032D9C1020627C102065180000100");
		OraCdcRedoRecord rrUpdate1 = new OraCdcRedoRecord(orl, 0x0000058dd9ff3633l, "0x0042cd.0059385f.0010", baUpdate1);
		assertTrue(rrUpdate1.has5_1());
		assertTrue(rrUpdate1.change5_1().supplementalLogData());
		assertTrue(rrUpdate1.change5_1().supplementalFb() != 0);
		assertTrue(rrUpdate1.change5_1().fb() != 0);
		assertFalse(rrUpdate1.has10_x());
		assertTrue(rrUpdate1.has11_x());
		assertEquals(rrUpdate1.change11_x().operation, _11_5_URP);
		assertTrue(rrUpdate1.change11_x().fb() != 0);

		byte[] baLmn1 = hexToRaw("CC04000001008D055E36FFD9010000FF07D7CD5100008D050502BB001500FFFF58CE5A035136FFD98D0500000100FFFF030000000000000004002000190075520000000050D984154F6201000A00D8030000000000000000000000000501BC005600FFFF50D984155E36FFD98D0500000101FFFF0300000000000000E00014001800100010001C00D000D0000500020005000300020009000700070007000200030002000100000003000000000000000100010000000000030003000300000000000000000000000000020004000A0001000100000000000000000000000000000000000000050007000000000000000000030007000200000000001C000B0007000A00000003000300000000000A0000000300000000000000000000000300030001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000D80394010A000000560019008E7533004F620119DBA70200DBA702000E0000004FD984150B01190000008E75020DDAF90D0000004CD984154F622300ABFA8D1732D4C4087D09300101000000010868002E000000000000000010000040000000ABFA8D17030000000100020003000400050006000700080009000A000B000C000D000E000F0010001100120013001400150016001700180019001A001B001C001D001E001F0020002100220023002400250026002700280029002A002B002C002D002E002F0030003100320033003400350036003700380039003A003B003C003D003E003F0040004100420043004400450046004700480049004A004B004C004D004E004F0050005100520053005400550056005700580059005A005B005C005D005E005F006000610062006300640065006600670068000500020005000300020009000700070007000200030002000100FFFF0300FFFFFFFFFFFF01000100FFFFFFFF030003000300FFFFFFFFFFFFFFFFFFFFFFFF020004000A0001000100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF05000700FFFFFFFFFFFFFFFF030007000200FFFFFFFF1C000B0007000A00FFFF03000300FFFFFFFF0A00FFFF0300FFFFFFFFFFFFFFFFFFFF030003000100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC41B11455B000B01C1540000C411214C2F00FED9C20B0200C1030000353635313036323537000000787D0C0501010100787D0C05010101FF787D0C05183C01D945410000C21055FF4541000080000000C21055008000100053000200C2033E00C2452D12C2422A00C1540400C30729483432383333343531333802008000000080000000C4023C5E15008048787D0C05183C0100C23D0615787D0B1D09242508C102C4083030303030315F554E53504543494649455F4C5F5354414E44415244554E53504543494649454400434F4C4C454354005348495020504F494E540200C20D16083E6366D934323833333435313338000030303200C1020600C1020600800000000B1001005E000200ABFA8D173336FFD98D0500000200DBA703000000000000000800100010001C00020D0925817F000050D984154F620100ABFA8D1732D4C4087D09100101000000010800002E000000000000000010000040000000ABFA8D1703000000");
		OraCdcRedoRecord rrLmn1 = new OraCdcRedoRecord(orl, 0x0000058dd9ff365el, "0x0042cd.00593966.00b4", baLmn1);
		assertTrue(rrLmn1.has5_1());
		assertTrue(rrLmn1.change5_1().supplementalLogData());
		assertTrue(rrLmn1.change5_1().supplementalFb() != 0);
		assertTrue(rrLmn1.change5_1().fb() != 0);
		assertFalse(rrLmn1.has10_x());
		assertTrue(rrLmn1.has11_x());
		assertEquals(rrLmn1.change11_x().operation, _11_16_LMN);
		assertTrue(rrLmn1.change11_x().fb() != 0);

		byte[] baUpdate2 = hexToRaw("2808000001008D055E36FFD90200000007D7CD51000002000501BC005600FFFF50D984155E36FFD98D0500000200FFFF030000000000000012021400180010001D000C000700030006000100020000001C00F401F401000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000070003000300040007000600000000000000000000000000080000000100010001000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000070000000700000009000800010001000100030000000000000000000000000000000000040004000000000000000000000000000000000002001300000000000300000003000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000001000000010006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000003000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000100000000004C07FC1B22000000560019008E7533004F620200DBA70200DBA702000E000000000000000B01190100008E75020D0000000000004CD984154F622300ABFA8D1732D4C4087D09250101000000040100000200FF06000020000091C4083500360037007600C100DA00787D0B1D09242E00C23428D9C5023013032CFFFF4E1C0000C10504000144FA002E009E009E0000000010000000000000ABFA8D170300000069006A006B006C006D006E006F0070007100720073007400750076007700780079007A007B007C007D007E007F0080008100820083008400850086008700880089008A008B008C008D008E008F0090009100920093009400950096009700980099009A009B009C009D00A100A200A300A400A500A600A700A800A900AA00AB00AC00AD00AE00AF00B000B100B200B300B400B500B600B700B800B900BA00BB00BC00BD00BE00BF00C000C100C200C300C400C500C600C700C800C900CA00CB00CC00CD00CE00CF00D000D100D200D300D400D500D600D700D800D900DA00DB00DC00DD00DE00E000E100E200E300E400E500E600E700E800E900EA00EB00EC00ED00EE00EF00F000F100F200F300F400F500F600F700F800F900FA00FB00FC00FD00FE00FF0000010101020103010401050106010701080109010A010B010C010D010E010F0110011101120113011401150116011701180119011A011B011C011D011E011F0120012101220123012401250126012701280129012B012C012D012E012F0130013101320133013401350136013701380139013A013B013C013D013E013F014001410142014401450146014701480149014A014B014C014D014E014F0150015101520153015401550156015701580159015A015B015C015D015E015F01600161016201630164016501660167016801FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF070003000300040007000600FFFFFFFFFFFFFFFFFFFFFFFF0800FFFF0100010001000500FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0700FFFF0700FFFF090008000100010001000300FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF04000400FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF02001300FFFFFFFF0300FFFF0300FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0100FFFFFFFFFFFF0100FFFF01000600FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF03000300FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0100FFFFFFFFFFFFFFFFFFFFFFFF0100FFFF787D0B1D092425FFC2342800C2073D00C3045F2B787D0B1D09242000C5022D632B4EB40F5354414E444152444E482E004E3D240059A002004F52444552000000787E0C0501010123787D0C05183C01005343484544554C45443D2300494E5445524E414C4E09250159000000590000003E626601C3535E0E43555354C1075405323032353131323920303833313138202B2E320030303200C10206008000020059B1B6084EDBFED9424F4F4B454492A059000000C1020600C102060046000200800000004E0D00000B0501005E000200ABFA8D175E36FFD98D0500000100DBA70300000000000000140010001D000C00070003000600010002000000020D00000100000050D984154F620200ABFA8D1732D4C4087D09050101000000040100000200FF06000020000000FFFF3500360037007600C100DA00787D0B1D09242F00C2342800C5023013032C000059000400C1062E00");
		OraCdcRedoRecord rrUpdate2 = new OraCdcRedoRecord(orl, 0x0000058dd9ff365el, "0x0042cd.00593968.01a0", baUpdate2);
		assertTrue(rrUpdate2.has5_1());
		assertTrue(rrUpdate2.change5_1().supplementalLogData());
		assertTrue(rrUpdate2.change5_1().supplementalFb() != 0);
		assertTrue(rrUpdate2.change5_1().fb() != 0);
		assertFalse(rrUpdate2.has10_x());
		assertTrue(rrUpdate2.has11_x());
		assertEquals(rrUpdate2.change11_x().operation, _11_5_URP);
		assertTrue(rrUpdate2.change11_x().fb() != 0);

		byte[] baLmn2 = hexToRaw("88040000010D8D056436FFD90500001507D7CD510000B6080501BC005600FFFF50D984156136FFD98D0500000B00FFFF0300000000000000E00014001800100010001C00D000D0000500020005000300020009000700070007000200030002000100000003000000000000000100010000000000030003000300000000000000000000000000020004000A0001000100000000000000000000000000000000000000050007000000000000000000030007000200000000001C000B0007000A00000003000300000000000A0000000300000000000000000000000300030001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000D803060922000000560019008E7533004F621100DBA70200DBA702000E000000000000000B01191000008E75020DD9CE0D00000050D984154F620200ABFA8D1732D4C4087D09300101000000010868002E000000000000000010000040000000ABFA8D17030000000100020003000400050006000700080009000A000B000C000D000E000F0010001100120013001400150016001700180019001A001B001C001D001E001F0020002100220023002400250026002700280029002A002B002C002D002E002F0030003100320033003400350036003700380039003A003B003C003D003E003F0040004100420043004400450046004700480049004A004B004C004D004E004F0050005100520053005400550056005700580059005A005B005C005D005E005F006000610062006300640065006600670068000500020005000300020009000700070007000200030002000100FFFF0300FFFFFFFFFFFF01000100FFFFFFFF030003000300FFFFFFFFFFFFFFFFFFFFFFFF020004000A0001000100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF05000700FFFFFFFFFFFFFFFF030007000200FFFFFFFF1C000B0007000A00FFFF03000300FFFFFFFF0A00FFFF0300FFFFFFFFFFFFFFFFFFFF030003000100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC41B11455B000000C1540000C411214C2F1C0000C20B0200C1030000353635313036323537050100787D0C0501010108787D0C0501010100787D0C05183C010045410000C21055004541020080000000C21055008000000053BE8115C2033E00C2452D08C2422A08C1540501C30729483432383333343531333800008002565F80000000C4023C5E15010000787D0C05183C01D9C23D0651787D0B1D09242500C1029C003030303030315F554E53504543494649455F4C5F5354414E44415244554E53504543494649454400434F4C4C454354175348495020504F494E542E00C20D16003E63660034323833333435313338000030303213C1020648C1020600800000000B1001005E000200ABFA8D175E36FFD98D0500000200DBA703000000000000000800100010001C00020D00000000000050D984154F621100ABFA8D1732D4C4087D09100101000000010800002E000000000000000010000040000000ABFA8D1703000000");
		OraCdcRedoRecord rrLmn2 = new OraCdcRedoRecord(orl, 0x0000058dd9ff3664l, "0x0042cd.00593989.018c", baLmn2);
		assertTrue(rrLmn2.has5_1());
		assertTrue(rrLmn2.change5_1().supplementalLogData());
		assertTrue(rrLmn2.change5_1().supplementalFb() != 0);
		assertTrue(rrLmn2.change5_1().fb() != 0);
		assertFalse(rrLmn2.has10_x());
		assertTrue(rrLmn2.has11_x());
		assertEquals(rrLmn2.change11_x().operation, _11_16_LMN);
		assertTrue(rrLmn2.change11_x().fb() != 0);

		
		byte[] baUpdate3 = hexToRaw("8408000001008D056436FFD90600000007D7CD51000081150502BB001500FFFF58CE5A035E36FFD98D0500000100FFFF03000000000000000400200019007F070000000051D984154F6201000A005407817F000000000000000000000501BC005600FFFF51D984156436FFD98D0500000101FFFF030000000000000012021400180010001D000A00070003000600060002001C00F601F60100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007000300030004000700060000000000000000000000000008000000010001000100050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007000000070000000900080001000100010003000000000000000000000000000000000004000400000000000100000000000000000000000000020013000000000003000000030000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000010000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000300030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000001000000000054072C050A000000560019008E7533004F620100DBA70200DBA702000E00000050D984150B01190000008E75020D00000000000050D984154F620200ABFA8D1732D4C4087D0925010100000004011F000200FF05F5FF000000A002003500360037009E00C1000000787D0B1D09242F48C2342800C5023013032C8115424F4F4B4544B608C106C4080144FB002E009E009E0000000010000000000000ABFA8D170300000069006A006B006C006D006E006F0070007100720073007400750076007700780079007A007B007C007D007E007F0080008100820083008400850086008700880089008A008B008C008D008E008F0090009100920093009400950096009700980099009A009B009C009D00A100A200A300A400A500A600A700A800A900AA00AB00AC00AD00AE00AF00B000B100B200B300B400B500B600B700B800B900BA00BB00BC00BD00BE00BF00C000C100C200C300C400C500C600C700C800C900CA00CB00CC00CD00CE00CF00D000D100D200D300D400D500D600D700D800D900DA00DB00DC00DD00DE00DF00E000E100E200E300E400E500E600E700E800E900EA00EB00EC00ED00EE00EF00F000F100F200F300F400F500F600F700F800F900FA00FB00FC00FD00FE00FF000001010102010301040105010601080109010A010B010C010D010E010F0110011101120113011401150116011701180119011A011B011C011D011E011F0120012101220123012401250126012701280129012B012C012D012E012F0130013101320133013401350136013701380139013A013B013C013D013E013F0140014101420143014401450146014701480149014A014B014C014D014E014F0150015101520153015401550156015701580159015A015B015C015D015E015F016001610162016301640165016601670168012E00FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF070003000300040007000600FFFFFFFFFFFFFFFFFFFFFFFF0800FFFF0100010001000500FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0700FFFF0700FFFF090008000100010001000300FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF04000400FFFFFFFF0100FFFFFFFFFFFFFFFFFFFFFFFF02001300FFFFFFFF0300FFFF0300FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0100FFFFFFFFFFFF0100FFFF0100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF03000300FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0100FFFFFFFFFFFFFFFFFFFFFFFF0100FFFF8D05787D0B1D09242500C2342851C2073D00C3045F2B787D0B1D09242015C5022D632B4E00005354414E444152444E0000004E001400590010004F52444552001400787E0C0501010100787D0C05183C01005343484544554C4544A00200494E5445524E414C4E01041A59008048590D00003E626600C3535E0E4355535459B1B608C107C408323032353131323920303833313138202B2E3200303032D9C102060080D7CD51591C00004E00040059000000C1020600C102060046050100800002004EB1B6080B0501005E000200ABFA8D176436FFD98D0500000100DBA70300000000000000120010001D000A00070003000600110002000100020D00000100000051D984154F620100ABFA8D1732D4C4087D0905010100000004011F000200FF050B00000000DBFED93500360037009E00C1000000787D0B1D09242FFFC2342815C5023013032C00004157414954494E475F5348495050494E47001000C1070200");
		OraCdcRedoRecord rrUpdate3 = new OraCdcRedoRecord(orl, 0x0000058dd9ff3664l, "0x0042cd.0059398c.0044", baUpdate3);
		assertTrue(rrUpdate3.has5_1());
		assertTrue(rrUpdate3.change5_1().supplementalLogData());
		assertTrue(rrUpdate3.change5_1().supplementalFb() != 0);
		assertTrue(rrUpdate3.change5_1().fb() != 0);
		assertFalse(rrUpdate3.has10_x());
		assertTrue(rrUpdate3.has11_x());
		assertEquals(rrUpdate3.change11_x().operation, _11_5_URP);
		assertTrue(rrUpdate3.change11_x().fb() != 0);

		byte[] baUpdate4 = hexToRaw("1C0B000005048D053336FFD90200006407D7CD51000046470100020011020000CE030000085433052836FFD98D0500000936FFD98D0500009936FFD98D050000E2F99F480501BC005600FFFF4CD984153336FFD98D0500000100FFFF030000000000000012021400180010003B00E6010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700030007000300060003000400070006000000000000000000000000000800000001000100000005000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007000000000000000000080001000100010003000000000000000000000000000000000004000400000000000100000000000000000000000000020013000000030000000300000000000000000000000000000000000000000000000000000000000000000000000000010000000000000001000000010006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000002000000030003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001001C001A001A00000000000000000000000000000000000000000000000100000000007C05121022000000560019008E7533004F622345DBA70200DBA702000E000000000000000B01192200008E75020D0000000000004CD984154F622200ABFA8D1732D4C4087D09250101000000040147000200FFF3EFFFFFFFFFFFFFFF07F04BFFFF7F0FFED94FFDFFEFF2FFFFFD2FFFFFBFFFFFFF0300000000000100020003000400050006000700080009000A000B000C000D000E000F0010001100120013001400150016001700180019001A001B001C001D001E001F0020002100220023002400250026002700280029002A002B002C002D002E002F0030003100320033003400350036003700380039003A003B003C003D003E003F0040004100420043004400450046004700480049004A004B004C004D004E004F0050005100520053005400550056005700580059005A005B005C005E005F0060006100620063006400650066006700680069006A006B006C006D006E006F0070007100720073007400750076007700780079007A007B007C007D007E007F00810082008300840085008600870088008A008B008C008D008E008F0090009100920093009400950096009700980099009A009B009C009D009E009F00A000A100A200A300A400A500A600A700A800A900AA00AB00AC00AD00AE00AF00B000B100B200B300B400B700B800B900BA00BB00BC00BD00BE00BF00C000C100C200C300C400C500C600C700C800C900CA00CB00CC00CD00CE00CF00D000D100D200D300D400D500D600D700D800DA00DB00DC00DD00DF00E000E100E200E300E400E500E700E800E900EA00EB00EC00ED00EE00EF00F000F100F200F300F800F900FA00FB00FC00FD00FE00FFFF787D0B1D09242500C2342800787D0B1D09242CFFC23428FFC5023013032CFFFFC2073DFFC3045F2B787D0B1D09242000C5022D632B4EFFFF5354414E444152444EFFFFFF4EFFFFFF4F52444552FFFFFF787E0C05010101FF494E5445524E414C4EFFFFFF59FFFFFF59FFFFFF3E6266FFC3535E0E435553544E00FFFFC1071346323032353131323920303833313138202B2E320030303200C102066480646400594646474E420000424F4F4B4544000059543300C1046464C1020600C1020600463735004E00000001440D002E006900690000000010000000000000ABFA8D1703000000C600E900F2001E011F01420147014F015D015E015F01600168010200FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0100FFFF100080001C000B0501005E000200ABFA8D173336FFD98D0500000100DBA70300000000000000EE0110003B00E6010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700030007000300060003000400070006000000000000000000000000000800000001000100010005000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007000000070000000900080001000100010003000000000000000000000000000000000004000400000000000100000000000000000000000000020013000000030000000300000000000000000000000000000000000000000000000000000000000000000000000000010000000000000001000000010006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000002000000030003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000020D0100000000004CD984154F622300ABFA8D1732D4C4087D09050101000000040147000200FFF31100FFFFFFFFFFFF07F00BFFFF7F05FED94FFDFFEFF2FFFFFD2FFFFFBFFFFFFF0300000000000100020003000400050006000700080009000A000B000C000D000E000F0010001100120013001400150016001700180019001A001B001C001D001E001F0020002100220023002400250026002700280029002A002B002C002D002E002F0030003100320033003400350036003700380039003A003B003C003D003E003F0040004100420043004400450046004700480049004A004B004C004D004E004F0050005100520053005400550056005700580059005A005B005C005E005F0060006100620063006400650066006700680069006A006B006C006D006E006F0070007100720073007400750076007700780079007A007B007C007D007E007F00810082008300840085008600870088008A008B008C008D008E008F0090009100920093009400950096009700980099009A009B009C009D009E009F00A000A100A200A300A400A500A600A700A800A900AA00AB00AC00AD00AE00AF00B000B100B200B300B400B700B800B900BA00BB00BC00BD00BE00BF00C000C100C200C300C400C500C600C700C800C900CA00CB00CC00CD00CE00CF00D000D100D200D300D400D500D600D700D800DA00DB00DC00DD00DF00E000E100E200E300E400E500E700E800E900EA00EB00EC00ED00EE00EF00F000F100F200F300F800F900FA00FB00FC00FD00FE000300787D0B1D092425FFC23428FF787D0B1D09242EFFC23428FFC5023013032CFFFFC2073DFFC3045F2B787D0B1D092420FFC5022D632B4EFFFF5354414E444152444EFFFFFF4EFFFFFF59FFFFFF4F52444552FFFFFF787E0C05010101FF787D0C05183C01FF5343484544554C4544000200494E5445524E414C4E033EFF5978020C592C07D93E626600C3535E0E435553544E646464C1076400323032353131323920303833313138202B2E320030303264C102061580323300593737184E000000424F4F4B4544000059554E2DC1052030C1020600C1020638463620204E150000");
		OraCdcRedoRecord rrUpdate4 = new OraCdcRedoRecord(orl, 0x0000058dd9ff3633l, "0x0042cd.00593a16.0010", baUpdate4);
		assertTrue(rrUpdate4.has5_1());
		assertTrue(rrUpdate4.change5_1().supplementalLogData());
		assertTrue(rrUpdate4.change5_1().supplementalFb() != 0);
		assertTrue(rrUpdate4.change5_1().fb() != 0);
		assertFalse(rrUpdate4.has10_x());
		assertTrue(rrUpdate4.has11_x());
		assertEquals(rrUpdate4.change11_x().operation, _11_5_URP);
		assertTrue(rrUpdate4.change11_x().fb() != 0);

		assertEquals(rrLmn1.halfDoneKey(), rrUpdate3.halfDoneKey());

		OraCdcTransaction transaction = new OraCdcTransactionArrayList("0x0056.019.0033758e", 0x0000058dd9ff3b9fl, 0x10, orl.cdb());
		OraCdcRedoMinerStatement stmt = new OraCdcRedoMinerStatement();
		try {
			transaction.processRowChange(rrUpdate1, false, System.currentTimeMillis());
			transaction.processRowChangeLmn(rrLmn1, System.currentTimeMillis());
			transaction.processRowChange(rrUpdate2, false, System.currentTimeMillis());
			transaction.processRowChangeLmn(rrLmn2, System.currentTimeMillis());
			transaction.processRowChange(rrUpdate3, false, System.currentTimeMillis());
			transaction.processRowChange(rrUpdate4, false, System.currentTimeMillis());

			transaction.setCommitScn(0x0000058dd7ec0179l);

			assertTrue(transaction.completed());

			assertTrue(transaction.getStatement(stmt));
			assertEquals(stmt.getOperation(), UPDATE);
			assertEquals(stmt.getRba(), rrUpdate1.rba());
			assertEquals(stmt.getRowId().toString(), "AAAqfbABeAADfqrAAD");
			System.out.println(stmt);

			assertTrue(transaction.getStatement(stmt));
			assertEquals(stmt.getOperation(), UPDATE);
			assertEquals(stmt.getRba(), rrLmn1.rba());
			assertEquals(stmt.getRowId().toString(), "AAAqfbABeAADfqrAAD");
			System.out.println(stmt);

			assertTrue(transaction.getStatement(stmt));
			assertEquals(stmt.getOperation(), UPDATE);
			assertEquals(stmt.getRba(), rrLmn2.rba());
			assertEquals(stmt.getRowId().toString(), "AAAqfbABeAADfqrAAD");
			System.out.println(stmt);

		} catch(IOException ioe) {}
	}

		
}
