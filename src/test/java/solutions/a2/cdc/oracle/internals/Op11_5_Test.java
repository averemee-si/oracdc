/**
 * Copyright (c) 2018-present, A2 Re≈°itve d.o.o.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in
 * compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License is
 * distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See
 * the License for the specific language governing permissions and limitations under the License.
 */

package solutions.a2.cdc.oracle.internals;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertFalse;
import static org.junit.jupiter.api.Assertions.assertNotEquals;
import static org.junit.jupiter.api.Assertions.assertTrue;
import static solutions.a2.cdc.oracle.OraCdcTransaction.LobProcessingStatus.REDOMINER;
import static solutions.a2.cdc.oracle.OraCdcV$LogmnrContents.UPDATE;
import static solutions.a2.cdc.oracle.internals.OraCdcChange._11_5_URP;
import static solutions.a2.oracle.utils.BinaryUtils.hexToRaw;

import java.io.IOException;
import java.nio.file.Path;
import java.sql.SQLException;
import java.time.ZoneId;

import org.junit.jupiter.api.Test;

import solutions.a2.cdc.oracle.OraCdcLobExtras;
import solutions.a2.cdc.oracle.OraCdcRawTransaction;
import solutions.a2.cdc.oracle.OraCdcRedoMinerStatement;
import solutions.a2.cdc.oracle.OraCdcTransactionArrayList;
import solutions.a2.oracle.internals.Xid;

/**
 *  
 * @author <a href="mailto:averemee@a2.solutions">Aleksei Veremeev</a>
 * 
 */
public class Op11_5_Test extends TestWithOutput {

	@Test
	public void singleRedoRecord() {

		var orl = OraCdcRedoLog.getLinux19c();

		var baUpdate1 = hexToRaw("5C02000005000000EAFCDC03010000003A00ADD1000030000000010002000000020000000A002D00E9FCDC0300000000E8FCDC0300000000EDFCDC03000000009A759C48050215000B00FFFFA000400299F0DC03000000000100FFFF0300000000000000060020000400000010000000F70E0000B70E40023C0318005200A4000000000000000000000000003A00ADD1050116000B00FFFFB70E400298F0DC03000000000300FFFF0300000000000000120014004C0008001D0004000300020014000000A400040D1200000003001000F70E00003C031800412701004127010005000000000000000B011000080C010000000000B70E40023C03150042DFDC030000000058DFDC0300000000FFFF0000FFFFFFFFFFFFFFFFB50E40020000000000000000030D000000000000DB000003DA000003FA122501020000002C00000000000802010000000012470105000600C20D3346C2065345011C0000010006000600000000100000000200000B0501000C000100DB0000039AE2DC03000000000102412703000000000000000C0046001D00040002000200110D00000000000003001000F70E0000B70E40023C031800000000000000000000000000C0BFC57EFFFF000002010D00EAFCDC0300800000010600809AE2DC030000000000000546DB000003DA000003FA120501020000002C02000000000802FFFF0000000206C505000600C2105452C20904540514000000000000000000000000000000000000000600000300000000000000120008000000060004000400000000000300F37E00006A62E8000000000001000000802C00000013FFFFFFFF53595331");
		var rrUpdate1 = new OraCdcRedoRecord(orl, 0x0000000003dcfceal, "0x000363.000042db.0010", baUpdate1);
		assertTrue(rrUpdate1.has5_1());
		assertTrue(rrUpdate1.change5_1().supplementalLogData());
		assertTrue(rrUpdate1.change5_1().supplementalFb() != 0);
		assertTrue(rrUpdate1.change5_1().fb() != 0);
		assertFalse(rrUpdate1.has10_x());
		assertTrue(rrUpdate1.has11_x());
		assertTrue(rrUpdate1.change11_x().fb() != 0);
		assertEquals(rrUpdate1.change11_x().operation, _11_5_URP);

		var raw = new OraCdcRawTransaction(new Xid((short)3, (short)0x10, 0xef7), ZoneId.systemDefault(), 0x10, new OraCdcLobExtras());
		try {
			raw.add(rrUpdate1, (int)(System.currentTimeMillis() / 1000));
			raw.commitScn(0x0000000003dcfcebl);
			var transaction = new OraCdcTransactionArrayList(raw, orl.cdb(), REDOMINER, Path.of(System.getProperty("java.io.tmpdir")));
			var stmt = new OraCdcRedoMinerStatement();

			assertTrue(transaction.completed());

			assertTrue(transaction.getStatement(stmt));
			assertEquals(stmt.getOperation(), UPDATE);
			assertEquals(stmt.getRba(), rrUpdate1.rba());
			assertEquals(stmt.getRowId().toString(), "AAASdBAAMAAAADbAAA");
			System.out.println(stmt);

		} catch(IOException | SQLException e) {}
	}

	@Test
	public void testMtlSystemItemsB() {

		var orl = OraCdcRedoLog.getLinux19c();

		var baUpdate1 = hexToRaw("B408000001008D05A06CAAF8350000F807D7CD510000FFFF05011C005600FFFFB98C8315A06CAAF88D0500000900FFFF030000000000000038011400180010002C00F200070001000600010001002F000300000000000000000005001C000600020002000000000000000000000000000000050000000100010001000100010001000100010001000100010001000100010001000100020002000100010000000100010007000100010001000000000001000000000000000100000000000000070001000100010000000000070002000000000000000000020002000100020000000000000000000000040000000200000000000000000002000200000000000200000002000000000000000100010001000000020000000100010000000200010001000000010001000000000000000200000002001C003400340005000300070003000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000A0042E052200000006001D003B582F00C33709FFE5A40200E5A402000E000000000000000B011D0800003B58020DC2460C0000001E8A8315C3370900808E200A42B4C4087D09250108000000280860000D009379000080077F010020B03BCCC3D7B38E12B9000000020003000600070008000B000C000D000E0023002400250026002700280029002A002B002C002D002E002F0030003100320033003400350036003700380039003A003B003C003D003E003F0040004100420043004400450046004700480049004A004B004C004D004E004F0050005100520053005400550056005700580059005A005B005C005D005E005F0060006100620063006400650066006700680069006A006B006C006D006E006F0070007100720073007400750076007700780079007A007B007C007D007E007F0080008100820083008400850086008700880089008A008B008C008D008E008F00900091009200C203787D0C130B29343080323135C502305A225B17004E01000059008D054f52444552204f52444552204f52444552204f52444552204f52444552204f52444552204f52444552204f5244455200C24615004f524445520004004f52444552204f52444552204f52444552204f52444552204f5244454f5244455220020033320000455500004f52444552003B58590D000059000000590D440359372A004E7DFE035910C0034E092501590000004E0249004E00A0024E0000005908E8004E0094004E418D05594143484E080000C1029400C11900004E101149590000004E7DFE034E0000005741524E494E4700597DFE034E66AAF8590500004E00C6A4800000005741524E494E47004E0004004E0004004E0DCD495741524E494E4703C1043000C103FE03C102C00380090501C1020000C3295D27C103A002C1030000C1022400C1059400C102C0034E4143488001000080028D05C102AAF8420000004ED7CD51C10500004E011C004E00FFFF4E0D44035966AAF8C10200004541FFFF01081A0045000300030000000010000000000000808E200A0D00000001000200050006000A000B0010001100120013001400150016001700180019001A001B001C001D001E001F0020002100220023000500030007000300FFFFFFFF0800FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC403561438101149C2033E007878020C0B1B0600C20C1F004C423030373538300B05010035000200808E200A4E6AAAF88D0500000300E5A40300000000000000FA0010002C00F200070001000600010001002F000300000000000000000005001C000600020002000000000000000000000000000000050000000100010001000100010001000100010001000100010001000100010001000100020002000100010000000100010007000100010001000000000001000000000000000100000000000000070001000100010000000000070002000000000000000000020002000100020000000000000000000000040000000200000000000000000002000200000000000200000002000000000000000100010001000000020000000100010000000200010001000000010001000000000000000200000002000000020D020002000000B98C8315C3370900808E200A42B4C4087D09050108000000280860000D009379000080077F010020B03BCCC3D7B38E12B9000000020003000600070008000B000C000D000E0023002400250026002700280029002A002B002C002D002E002F0030003100320033003400350036003700380039003A003B003C003D003E003F0040004100420043004400450046004700480049004A004B004C004D004E004F0050005100520053005400550056005700580059005A005B005C005D005E005F0060006100620063006400650066006700680069006A006B006C006D006E006F0070007100720073007400750076007700780079007A007B007C007D007E007F0080008100820083008400850086008700880089008A008B008C008D008E008F009000910092000003787D0C130B2A0C0080011C00C502305A225B44034E66AAF8590500004f52444552204f52444552204f52444552204f52444552204f52444552204f52444552204f52444552204f5244455200C24615004f524445520000004f52444552204f52444552204f52444552204f52444552204f5244454f5244455220481233320000455500004f5244455203C20359FFFF0859423030593231365903FE7D4E001958590401004E001A00591548124E66AAF84E0500004E0035C6590000004E0000004E001000590000004E0D1000C1021300C11944034E37340059004D004E002E454E0100005741524E494E47F85900000B4ED7CD5159004F5A4E011C008000FFFF5741524E494E47F84E0500004E00FFFF4E0000005741524E494E4700C1041000C1031B00C102F60980000000C1021D00C3295D27C1033500C1030300C1021A00C1050000C10200004E161D3480003B58800D0000C1020000420D44034E372F00C10501484EE4C0034E1548124E00000059000000C10202C14541C203");
		var rrUpdate1 = new OraCdcRedoRecord(orl, 0x0000058df8aa6ca0l, "0x004366.00ee02a5.0030", baUpdate1);
		assertTrue(rrUpdate1.has5_1());
		assertTrue(rrUpdate1.change5_1().supplementalLogData());
		assertTrue(rrUpdate1.change5_1().supplementalFb() != 0);
		assertTrue(rrUpdate1.change5_1().fb() != 0);
		assertFalse(rrUpdate1.has10_x());
		assertTrue(rrUpdate1.has11_x());
		assertTrue(rrUpdate1.change11_x().fb() != 0);
		assertEquals(rrUpdate1.change11_x().operation, _11_5_URP);

		var baUpdate2 = hexToRaw("3801000001428D05A06CAAF83600007D07D7CD510000010005011C005600FFFFB98C8315A06CAAF88D0500000A00FFFF030000000000000012001400180010001D000400040002001C00000080008C002200000006001D003B582F00C3370AFFE5A40200E5A402000E000000000000000B011D0900003B58020DFA530A000000B98C8315C3370900808E200A42B4C4087D09250108000000000860000C00020200000000000000000000010045414348C10404000100000045009400940000000010000000000000808E200A0D0000000B05010035000200808E200AA06CAAF88D0500000100E5A403000000000000000C0010001D00040004000200020D61481D7F0000B98C8315C3370A00808E200A42B4C4087D09050108000000000860000C00020200000000000094000000010045414348C1040000");
		var rrUpdate2 = new OraCdcRedoRecord(orl, 0x0000058df8aa6ca0l, "0x004366.00ee02a9.0124", baUpdate2);
		assertTrue(rrUpdate2.has5_1());
		assertTrue(rrUpdate2.change5_1().supplementalLogData());
		assertTrue(rrUpdate2.change5_1().supplementalFb() == 0);
		assertTrue(rrUpdate2.change5_1().fb() == 0);
		assertFalse(rrUpdate2.has10_x());
		assertTrue(rrUpdate2.has11_x());
		assertTrue(rrUpdate2.change11_x().fb() == 0);
		assertEquals(rrUpdate2.change11_x().operation, _11_5_URP);

		var baUpdate3 = hexToRaw("B40C000001008D05A06CAAF83700000007D7CD510000AAF805021B001500FFFFD0004003A06CAAF88D0500000600FFFF0300000000000000040020001D00000000000000BA8C8315C33701000A00340605000000000000000000000005011C005600FFFFBA8C8315A06CAAF88D0500000101FFFF030000000000000012021400180010003C00F20104000400010008000200000002000000020000000100000002000000020002000000000000000000020000000200000002000000000000000000000000000100010001000000000001000000000000000000000000000100000000000000000000000000000000000100000001000100060003000400070001000000030000000100010001000100000001000200020002000000000001000100000000000000000000000000000000000000000000000000000000000000000000000000020001000000000000000000020000000000000001000100010000000000000000000000000000000B0001000200020001000300010001000200010000000100010000000000000000000000000000000000020000000100010000000000000001000000000001000800010000000000000000000000000000000000000002000100010000000000000000000000000000000200020002000000020000000000000000000200020002000200020000000000000000000000000000000000000000000000000000000000000000000000000001000000000001000100000000000000010001000000010000000000010001000100000000000000000001000000000000000000010002000000020001000000000000000000000000000000000000000000000000000000000001000900000002001C000E000E000000000000000000000000000000020034060A000A00000006001D003B582F00C33701FFE5A40200E5A402000E000000B98C83150B011D0000003B58020D000000000000B98C8315C3370A00808E200A42B4C4087D09250108000000040860001500FFF90000A02AAF7EECF72FA010E6FF7FDEF10720FF72E33FFEE8C1FFFFE634DE93FF9F00000000000100020003000400050006000700080009000A000B000C000D000E000F0010001100120013001400150016001700180019001A001B001C001D001E001F0020002100220023002400250026002700280029002A002B002C002D002E002F0030003100320033003400350036003700380039003A003B003C003D003E003F0040004100420043004400450046004700480049004A004B004C004D004E004F00500053005400550056005700580059005A005B005C005D005E005F0060006100620063006400650066006700680069006A006B006C006D006E006F0070007100720073007400750076007700780079007A007B007C007D007E007F0080008100820083008400850086008700880089008A008B008C008D008E008F0090009100920093009400950096009700980099009A009B009C009D009E009F00A000A100A200A300A600A700A800A900AA00AB00AC00AD00AE00AF00B000B100B200B300B400B500B600B700B800B900BA00BB00BC00BD00BE00BF00C000C100C200C300C400C500C600C700C800C900CA00CB00CC00CD00CE00CF00D000D100D200D300D400D500D600D700D800D900DA00DB00DC00DD00DE00DF00E000E100E200E300E400E500E600E700E800E900EB00EC00ED00EE00F000F100F200F300F400F500F600F700F800F900FA00FB00FC00FD00FE00C003C3295D2FC3295D2E59000000494E414354495645C107FF08C1033030C10233378003FE7DC11F0900C2150100C1021A00C1514812C103AAF8C10200004E0035C64E0000004E0000004E0010004E001B00590D44034E3737004E0D4403C5022E455F096300C205025AC3041F2E787D0C130B2934084E423030C20215375903FE7D4E0009F85901000050D78D054E66AAF8C1080000C103CD51C10383154E011C004E00FFFFC10244034E66AAF8C10300004E00FFFF4E0000004E000000554E5055424C4953484544004E000400494E0600C103080780000000C10533004E582F0059373C00C11A02004EA402005900000059000000C1021D3B80003B58800D00004E000000590D4403494E5445524E414C5910C003C10B25015000000050024900C103A002C1030000C1021900C1039400C1032E45C1034348C1040000C1049400C10400004E1011494E0000004E7DFE034E0000004E050100590002004E7DFE034E66AAF84E0500004E00C6A44E000000C1040000C10310004E0004004E00040044454641554C5449420D4403C1023C000144070045009600960000000010000000000000808E200A0D000000E700E8003A013B018001850195014348FFFFFFFFFFFFFFFFFFFFFFFFFFFF00000B05010035000200808E200AA06CAAF88D0500000200E5A40300000000000000FA0110003C00F20104000400010008000200000002000000020000000100000002000000020002000000000000000000020000000200000002000000000000000000000000000100010001000000000001000000000000000000000000000100000000000000000000000000000000000100000001000100060003000400070001000000030000000100010001000100000001000200020002000000000001000100000000000000000000000000000000000000000000000000000000000000000000000000020001000000000000000000020000000000000001000100010000000000000000000000000000000B0001000200020001000300010001000200010000000100010000000000000000000000000000000000020000000100010000000000000001000000000001000800010000000000000000000000000000000000000002000100010000000000000000000000000000000200020002000000020000000000000000000200020002000200020000000000000000000000000000000000000000000000000000000000000000000000000001000000000001000100000000000000010001000000010000000000010001000100000000000000000001000000000000000000010002000000020001000000000000000000000000000000000000000000000000000000000001000900000002000000020D0000E84903DABA8C8315C3370100808E200A42B4C4087D09050108000000040860001500FFF90000A02AAF7EECF72FA010E6FF7FDEF10720FF72E33FFEE8C1FFFFE634DE93FF9F00000000000100020003000400050006000700080009000A000B000C000D000E000F0010001100120013001400150016001700180019001A001B001C001D001E001F0020002100220023002400250026002700280029002A002B002C002D002E002F0030003100320033003400350036003700380039003A003B003C003D003E003F0040004100420043004400450046004700480049004A004B004C004D004E004F00500053005400550056005700580059005A005B005C005D005E005F0060006100620063006400650066006700680069006A006B006C006D006E006F0070007100720073007400750076007700780079007A007B007C007D007E007F0080008100820083008400850086008700880089008A008B008C008D008E008F0090009100920093009400950096009700980099009A009B009C009D009E009F00A000A100A200A300A600A700A800A900AA00AB00AC00AD00AE00AF00B000B100B200B300B400B500B600B700B800B900BA00BB00BC00BD00BE00BF00C000C100C200C300C400C500C600C700C800C900CA00CB00CC00CD00CE00CF00D000D100D200D300D400D500D600D700D800D900DA00DB00DC00DD00DE00DF00E000E100E200E300E400E500E600E700E800E900EB00EC00ED00EE00F000F100F200F300F400F500F600F700F800F900FA00FB00FC00FD00FE001D40C3295D2FC3295D2E59000000494E414354495645C1070148C103C003C102481280000000C11F0000C21502C1C102C203C151FF08C1033030C10233384E03FE7D4E000D054E0201004E001A004E1548125966AAF84E0500004E0035C6C5022E455F090000C2050200C3041F2E787D0C130B2A0C004E0D4403C2021500590064004E000100598002C15003C2034EFFFF08C1083030C1033338C103FE7D4E000D004E010000C1028D054E66AAF8C10300004ED7CD514E001D494E011C00554E5055424C4953484544F84E050000494EFFFFC103000080000000C10533004E00100059000400C11A04004E0006005900800459000000C1021D0080582F00803742004EA4020059A40200494E5445524E414C59011D41C10C3B58500D000050000000C1034403C1033C00C102FE03C103C003C1032501C1030000C1044900C104A002C10400004E0014004E0094004E4102004E4143484E080000590094004E0000004E1011494E0000004E7DFE034E000000C1040100C10302004E7DFE034E66AAF844454641554C544942000000C1020000");
		var rrUpdate3 = new OraCdcRedoRecord(orl, 0x0000058df8aa6ca0l, "0x004366.00ee02aa.006c", baUpdate3);
		assertTrue(rrUpdate3.has5_1());
		assertTrue(rrUpdate3.change5_1().supplementalLogData());
		assertTrue(rrUpdate3.change5_1().supplementalFb() != 0);
		assertTrue(rrUpdate3.change5_1().fb() != 0);
		assertFalse(rrUpdate3.has10_x());
		assertTrue(rrUpdate3.has11_x());
		assertTrue(rrUpdate3.change11_x().fb() != 0);
		assertEquals(rrUpdate3.change11_x().operation, _11_5_URP);

		var raw = new OraCdcRawTransaction(new Xid((short)6, (short)0x1d, 0x2f583b), ZoneId.systemDefault(), 0x10, new OraCdcLobExtras());
		try {
			raw.add(rrUpdate1, (int)(System.currentTimeMillis() / 1000));
			raw.add(rrUpdate2, (int)(System.currentTimeMillis() / 1000));
			raw.add(rrUpdate3, (int)(System.currentTimeMillis() / 1000));
			raw.commitScn(0x0000058df8aa6ca1l);
			var transaction = new OraCdcTransactionArrayList(raw, orl.cdb(), REDOMINER, Path.of(System.getProperty("java.io.tmpdir")));
			var stmt = new OraCdcRedoMinerStatement();

			assertTrue(transaction.completed());

			assertTrue(transaction.getStatement(stmt));
			assertEquals(stmt.getOperation(), UPDATE);
			assertEquals(stmt.getRba(), rrUpdate1.rba());
			assertEquals(stmt.getRowId().toString(), "AAAqTlAAoAAII6AAAN");
			System.out.println(stmt);

			final String lmStatement = 
					"update \"UNKNOWN\".\"OBJ# 173285\" set \"COL 3\" = HEXTORAW('787d0c130b2a0c'), \"COL 4\" = HEXTORAW('80'), \"COL 7\" = HEXTORAW('c502305a225b'), \"COL 8\" = HEXTORAW('4e'), \"COL 9\" = HEXTORAW('59'), \"COL 12\" = HEXTORAW('4f52444552204f52444552204f52444552204f52444552204f52444552204f52444552204f52444552204f52444552'), \"COL 13\" = HEXTORAW('c24615'), \"COL 14\" = NULL, \"COL 15\" = NULL, \"COL 36\" = NULL, \"COL 37\" = NULL, \"COL 38\" = HEXTORAW('4f52444552'), \"COL 39\" = HEXTORAW('4f52444552204f52444552204f52444552204f52444552204f524445'), \"COL 40\" = HEXTORAW('4f5244455220'), \"COL 41\" = HEXTORAW('3332'), \"COL 42\" = HEXTORAW('4555'), \"COL 43\" = NULL, \"COL 44\" = NULL, \"COL 45\" = NULL, \"COL 46\" = NULL, \"COL 47\" = NULL, \"COL 48\" = NULL, \"COL 49\" = NULL, \"COL 50\" = HEXTORAW('4f52444552'), \"COL 51\" = NULL, \"COL 52\" = HEXTORAW('59'), \"COL 53\" = HEXTORAW('59'), \"COL 54\" = HEXTORAW('59'), \"COL 55\" = HEXTORAW('59'), \"COL 56\" = HEXTORAW('4e'), \"COL 57\" = HEXTORAW('59'), \"COL 58\" = HEXTORAW('4e'), \"COL 59\" = HEXTORAW('59'), \"COL 60\" = HEXTORAW('4e'), \"COL 61\" = HEXTORAW('4e'), \"COL 62\" = HEXTORAW('4e'), \"COL 63\" = HEXTORAW('59'), \"COL 64\" = HEXTORAW('4e'), \"COL 65\" = HEXTORAW('4e'), \"COL 66\" = HEXTORAW('59'), \"COL 67\" = HEXTORAW('4e'), \"COL 68\" = HEXTORAW('c102'), \"COL 69\" = HEXTORAW('c119'), \"COL 70\" = HEXTORAW('4e'), \"COL 71\" = HEXTORAW('59'), \"COL 72\" = NULL, \"COL 73\" = HEXTORAW('4e'), \"COL 74\" = HEXTORAW('4e'), \"COL 75\" = HEXTORAW('5741524e494e47'), \"COL 76\" = HEXTORAW('59'), \"COL 77\" = HEXTORAW('4e'), \"COL 78\" = HEXTORAW('59'), \"COL 79\" = NULL, \"COL 80\" = NULL, \"COL 81\" = HEXTORAW('4e'), \"COL 82\" = NULL, \"COL 83\" = NULL, \"COL 84\" = NULL, \"COL 85\" = HEXTORAW('80'), \"COL 86\" = NULL, \"COL 87\" = NULL, \"COL 88\" = NULL, \"COL 89\" = HEXTORAW('5741524e494e47'), \"COL 90\" = HEXTORAW('4e'), \"COL 91\" = HEXTORAW('4e'), \"COL 92\" = HEXTORAW('4e'), \"COL 93\" = NULL, \"COL 94\" = NULL, \"COL 95\" = HEXTORAW('5741524e494e47'), \"COL 96\" = HEXTORAW('c104'), \"COL 97\" = NULL, \"COL 98\" = NULL, \"COL 99\" = NULL, \"COL 100\" = NULL, \"COL 101\" = HEXTORAW('c103'), \"COL 102\" = HEXTORAW('c102'), \"COL 103\" = HEXTORAW('80'), \"COL 104\" = HEXTORAW('c102'), \"COL 105\" = NULL, \"COL 106\" = NULL, \"COL 107\" = NULL, \"COL 108\" = NULL, \"COL 109\" = NULL, \"COL 110\" = HEXTORAW('c3295d27'), \"COL 111\" = NULL, \"COL 112\" = HEXTORAW('c103'), \"COL 113\" = NULL, \"COL 114\" = NULL, \"COL 115\" = NULL, \"COL 116\" = NULL, \"COL 117\" = HEXTORAW('c103'), \"COL 118\" = HEXTORAW('c102'), \"COL 119\" = NULL, \"COL 120\" = NULL, \"COL 121\" = HEXTORAW('c105'), \"COL 122\" = NULL, \"COL 123\" = HEXTORAW('c102'), \"COL 124\" = NULL, \"COL 125\" = NULL, \"COL 126\" = NULL, \"COL 127\" = HEXTORAW('4e'), \"COL 128\" = HEXTORAW('80'), \"COL 129\" = HEXTORAW('80'), \"COL 130\" = NULL, \"COL 131\" = HEXTORAW('c102'), \"COL 132\" = NULL, \"COL 133\" = HEXTORAW('42'), \"COL 134\" = HEXTORAW('4e'), \"COL 135\" = NULL, \"COL 136\" = HEXTORAW('c105'), \"COL 137\" = HEXTORAW('4e'), \"COL 138\" = HEXTORAW('4e'), \"COL 139\" = NULL, \"COL 140\" = HEXTORAW('4e'), \"COL 141\" = HEXTORAW('59'), \"COL 142\" = NULL, \"COL 143\" = NULL, \"COL 144\" = NULL, \"COL 145\" = HEXTORAW('c102'), \"COL 146\" = NULL, \"COL 147\" = HEXTORAW('4541'), \"COL 148\" = HEXTORAW('45414348'), \"COL 149\" = HEXTORAW('c104'), \"COL 150\" = HEXTORAW('c3295d2f'), \"COL 151\" = HEXTORAW('c3295d2e'), \"COL 152\" = HEXTORAW('59'), \"COL 153\" = HEXTORAW('494e414354495645'), \"COL 154\" = HEXTORAW('c107'), \"COL 155\" = NULL, \"COL 156\" = HEXTORAW('c103'), \"COL 157\" = NULL, \"COL 158\" = HEXTORAW('c102'), \"COL 159\" = NULL, \"COL 160\" = HEXTORAW('80'), \"COL 161\" = NULL, \"COL 162\" = HEXTORAW('c11f'), \"COL 163\" = NULL, \"COL 164\" = HEXTORAW('c215'), \"COL 165\" = HEXTORAW('c102'), \"COL 166\" = NULL, \"COL 167\" = NULL, \"COL 168\" = NULL, \"COL 169\" = NULL, \"COL 170\" = HEXTORAW('c151'), \"COL 171\" = NULL, \"COL 172\" = HEXTORAW('c103'), \"COL 173\" = NULL, \"COL 174\" = HEXTORAW('c102'), \"COL 175\" = NULL, \"COL 176\" = NULL, \"COL 177\" = NULL, \"COL 178\" = NULL, \"COL 179\" = NULL, \"COL 180\" = NULL, \"COL 181\" = HEXTORAW('4e'), \"COL 182\" = HEXTORAW('4e'), \"COL 183\" = HEXTORAW('4e'), \"\n" +
					"COL 184\" = NULL, \"COL 185\" = NULL, \"COL 186\" = HEXTORAW('4e'), \"COL 187\" = NULL, \"COL 188\" = NULL, \"COL 189\" = NULL, \"COL 190\" = NULL, \"COL 191\" = NULL, \"COL 192\" = NULL, \"COL 193\" = HEXTORAW('4e'), \"COL 194\" = NULL, \"COL 195\" = NULL, \"COL 196\" = NULL, \"COL 197\" = NULL, \"COL 198\" = NULL, \"COL 199\" = NULL, \"COL 200\" = NULL, \"COL 201\" = NULL, \"COL 202\" = HEXTORAW('59'), \"COL 203\" = NULL, \"COL 204\" = HEXTORAW('4e'), \"COL 205\" = HEXTORAW('4e'), \"COL 206\" = HEXTORAW('c5022e455f09'), \"COL 207\" = HEXTORAW('c20502'), \"COL 208\" = HEXTORAW('c3041f2e'), \"COL 209\" = HEXTORAW('787d0c130b2a0c'), \"COL 210\" = HEXTORAW('4e'), \"COL 211\" = NULL, \"COL 212\" = HEXTORAW('c20215'), \"COL 213\" = NULL, \"COL 214\" = HEXTORAW('59'), \"COL 215\" = HEXTORAW('4e'), \"COL 216\" = HEXTORAW('59'), \"COL 217\" = HEXTORAW('50'), \"COL 218\" = NULL, \"COL 219\" = HEXTORAW('4e'), \"COL 220\" = HEXTORAW('c108'), \"COL 221\" = HEXTORAW('c103'), \"COL 222\" = HEXTORAW('c103'), \"COL 223\" = NULL, \"COL 224\" = NULL, \"COL 225\" = HEXTORAW('4e'), \"COL 226\" = HEXTORAW('4e'), \"COL 227\" = NULL, \"COL 228\" = NULL, \"COL 229\" = NULL, \"COL 230\" = NULL, \"COL 233\" = NULL, \"COL 234\" = NULL, \"COL 235\" = NULL, \"COL 236\" = NULL, \"COL 237\" = NULL, \"COL 238\" = NULL, \"COL 239\" = NULL, \"COL 240\" = NULL, \"COL 241\" = NULL, \"COL 242\" = NULL, \"COL 243\" = NULL, \"COL 244\" = NULL, \"COL 245\" = NULL, \"COL 246\" = NULL, \"COL 247\" = HEXTORAW('c102'), \"COL 248\" = HEXTORAW('4e'), \"COL 249\" = NULL, \"COL 250\" = NULL, \"COL 251\" = NULL, \"COL 252\" = NULL, \"COL 253\" = HEXTORAW('c103'), \"COL 254\" = NULL, \"COL 255\" = NULL, \"COL 256\" = NULL, \"COL 257\" = HEXTORAW('4e'), \"COL 258\" = HEXTORAW('4e'), \"COL 259\" = HEXTORAW('4e'), \"COL 260\" = NULL, \"COL 261\" = NULL, \"COL 262\" = NULL, \"COL 263\" = NULL, \"COL 264\" = NULL, \"COL 265\" = NULL, \"COL 266\" = NULL, \"COL 267\" = HEXTORAW('554e5055424c4953484544'), \"COL 268\" = HEXTORAW('4e'), \"COL 269\" = HEXTORAW('494e'), \"COL 270\" = HEXTORAW('c103'), \"COL 271\" = HEXTORAW('80'), \"COL 272\" = HEXTORAW('c10533'), \"COL 273\" = HEXTORAW('4e'), \"COL 274\" = HEXTORAW('59'), \"COL 275\" = HEXTORAW('c11a'), \"COL 276\" = HEXTORAW('4e'), \"COL 277\" = NULL, \"COL 278\" = HEXTORAW('59'), \"COL 279\" = HEXTORAW('59'), \"COL 280\" = NULL, \"COL 281\" = NULL, \"COL 282\" = NULL, \"COL 283\" = NULL, \"COL 284\" = NULL, \"COL 285\" = NULL, \"COL 286\" = NULL, \"COL 287\" = NULL, \"COL 288\" = HEXTORAW('c102'), \"COL 289\" = NULL, \"COL 290\" = HEXTORAW('80'), \"COL 291\" = HEXTORAW('80'), \"COL 292\" = NULL, \"COL 293\" = NULL, \"COL 294\" = NULL, \"COL 295\" = HEXTORAW('4e'), \"COL 296\" = NULL, \"COL 297\" = NULL, \"COL 298\" = HEXTORAW('59'), \"COL 299\" = HEXTORAW('494e5445524e414c'), \"COL 300\" = HEXTORAW('59'), \"COL 301\" = NULL, \"COL 302\" = NULL, \"COL 303\" = NULL, \"COL 304\" = NULL, \"COL 305\" = NULL, \"COL 306\" = NULL, \"COL 307\" = NULL, \"COL 308\" = NULL, \"COL 309\" = NULL, \"COL 310\" = HEXTORAW('c10c'), \"COL 311\" = HEXTORAW('50'), \"COL 312\" = HEXTORAW('50'), \"COL 313\" = NULL, \"COL 316\" = NULL, \"COL 317\" = NULL, \"COL 318\" = NULL, \"COL 319\" = NULL, \"COL 320\" = NULL, \"COL 321\" = NULL, \"COL 322\" = HEXTORAW('c103'), \"COL 323\" = HEXTORAW('c103'), \"COL 324\" = HEXTORAW('c102'), \"COL 325\" = NULL, \"COL 326\" = HEXTORAW('c103'), \"COL 327\" = NULL, \"COL 328\" = NULL, \"COL 329\" = NULL, \"COL 330\" = NULL, \"COL 331\" = HEXTORAW('c103'), \"COL 332\" = HEXTORAW('c103'), \"COL 333\" = HEXTORAW('c104'), \"COL 334\" = HEXTORAW('c104'), \"COL 335\" = HEXTORAW('c104'), \"COL 336\" = NULL, \"COL 337\" = NULL, \"COL 338\" = NULL, \"COL 339\" = NULL, \"COL 340\" = NULL, \"COL 341\" = NULL, \"COL 342\" = NULL, \"COL 343\" = NULL, \"COL 344\" = NULL, \"COL 345\" = NULL, \"COL 346\" = NULL, \"COL 347\" = NULL, \"COL 348\" = NULL, \"COL 349\" = NULL, \"COL 350\" = NULL, \"COL 351\" = NULL, \"COL 352\" = NULL, \"COL 353\" = NULL, \"COL 354\" = HEXTORAW('4e'), \"COL 355\" = NULL, \"COL 356\" = NULL, \"COL 357\" = HEXTORAW('4e'), \"COL 358\" = HEXTORAW('4e'), \"COL 359\" = NULL, \"COL 360\" = NULL, \"COL 361\" = NULL, \"COL 362\" = HEXTORAW('4e'), \"COL 363\" = HEXTORAW('4e'), \"COL 364\" = NULL, \"COL 365\" = HEXTORAW('59'), \"COL 366\" = NULL, \"COL 367\" = NULL, \"COL 368\"\n" +
					" = HEXTORAW('4e'), \"COL 369\" = HEXTORAW('4e'), \"COL 370\" = HEXTORAW('4e'), \"COL 371\" = NULL, \"COL 372\" = NULL, \"COL 373\" = NULL, \"COL 374\" = NULL, \"COL 375\" = HEXTORAW('4e'), \"COL 376\" = NULL, \"COL 377\" = NULL, \"COL 378\" = NULL, \"COL 379\" = NULL, \"COL 380\" = HEXTORAW('4e'), \"COL 381\" = HEXTORAW('c104'), \"COL 382\" = NULL, \"COL 383\" = HEXTORAW('c103'), \"COL 385\" = HEXTORAW('4e'), \"COL 386\" = NULL, \"COL 387\" = NULL, \"COL 388\" = NULL, \"COL 390\" = NULL, \"COL 391\" = NULL, \"COL 392\" = NULL, \"COL 393\" = NULL, \"COL 394\" = NULL, \"COL 395\" = NULL, \"COL 396\" = NULL, \"COL 397\" = NULL, \"COL 398\" = NULL, \"COL 399\" = NULL, \"COL 400\" = NULL, \"COL 401\" = HEXTORAW('4e'), \"COL 402\" = HEXTORAW('44454641554c544942'), \"COL 403\" = NULL, \"COL 404\" = HEXTORAW('c102') where \"COL 1\" = HEXTORAW('c403561438') and \"COL 2\" = HEXTORAW('c2033e') and \"COL 3\" = HEXTORAW('787d0c130b2934') and \"COL 4\" = HEXTORAW('80') and \"COL 5\" = HEXTORAW('7878020c0b1b06') and \"COL 6\" = HEXTORAW('c20c1f') and \"COL 7\" = HEXTORAW('c502305a225b') and \"COL 8\" = HEXTORAW('4e') and \"COL 9\" = HEXTORAW('59') and \"COL 10\" IS NULL and \"COL 11\" IS NULL and \"COL 12\" = HEXTORAW('4f52444552204f52444552204f52444552204f52444552204f52444552204f52444552204f52444552204f52444552') and \"COL 13\" = HEXTORAW('c24615') and \"COL 14\" IS NULL and \"COL 15\" IS NULL and \"COL 16\" = HEXTORAW('4c42303037353830') and \"COL 17\" IS NULL and \"COL 18\" IS NULL and \"COL 19\" IS NULL and \"COL 20\" IS NULL and \"COL 21\" IS NULL and \"COL 22\" IS NULL and \"COL 23\" IS NULL and \"COL 24\" IS NULL and \"COL 25\" IS NULL and \"COL 26\" IS NULL and \"COL 27\" IS NULL and \"COL 28\" IS NULL and \"COL 29\" IS NULL and \"COL 30\" IS NULL and \"COL 31\" IS NULL and \"COL 32\" IS NULL and \"COL 33\" IS NULL and \"COL 34\" IS NULL and \"COL 35\" IS NULL and \"COL 36\" IS NULL and \"COL 37\" IS NULL and \"COL 38\" = HEXTORAW('4f52444552') and \"COL 39\" = HEXTORAW('4f52444552204f52444552204f52444552204f52444552204f524445') and \"COL 40\" = HEXTORAW('4f5244455220') and \"COL 41\" = HEXTORAW('3332') and \"COL 42\" = HEXTORAW('4555') and \"COL 43\" IS NULL and \"COL 44\" IS NULL and \"COL 45\" IS NULL and \"COL 46\" IS NULL and \"COL 47\" IS NULL and \"COL 48\" IS NULL and \"COL 49\" IS NULL and \"COL 50\" = HEXTORAW('4f52444552') and \"COL 51\" IS NULL and \"COL 52\" = HEXTORAW('59') and \"COL 53\" = HEXTORAW('59') and \"COL 54\" = HEXTORAW('59') and \"COL 55\" = HEXTORAW('59') and \"COL 56\" = HEXTORAW('4e') and \"COL 57\" = HEXTORAW('59') and \"COL 58\" = HEXTORAW('4e') and \"COL 59\" = HEXTORAW('59') and \"COL 60\" = HEXTORAW('4e') and \"COL 61\" = HEXTORAW('4e') and \"COL 62\" = HEXTORAW('4e') and \"COL 63\" = HEXTORAW('59') and \"COL 64\" = HEXTORAW('4e') and \"COL 65\" = HEXTORAW('4e') and \"COL 66\" = HEXTORAW('59') and \"COL 67\" = HEXTORAW('4e') and \"COL 68\" = HEXTORAW('c102') and \"COL 69\" = HEXTORAW('c119') and \"COL 70\" = HEXTORAW('4e') and \"COL 71\" = HEXTORAW('59') and \"COL 72\" IS NULL and \"COL 73\" = HEXTORAW('4e') and \"COL 74\" = HEXTORAW('4e') and \"COL 75\" = HEXTORAW('5741524e494e47') and \"COL 76\" = HEXTORAW('59') and \"COL 77\" = HEXTORAW('4e') and \"COL 78\" = HEXTORAW('59') and \"COL 79\" IS NULL and \"COL 80\" IS NULL and \"COL 81\" = HEXTORAW('4e') and \"COL 82\" IS NULL and \"COL 83\" IS NULL and \"COL 84\" IS NULL and \"COL 85\" = HEXTORAW('80') and \"COL 86\" IS NULL and \"COL 87\" IS NULL and \"COL 88\" IS NULL and \"COL 89\" = HEXTORAW('5741524e494e47') and \"COL 90\" = HEXTORAW('4e') and \"COL 91\" = HEXTORAW('4e') and \"COL 92\" = HEXTORAW('4e') and \"COL 93\" IS NULL and \"COL 94\" IS NULL and \"COL 95\" = HEXTORAW('5741524e494e47') and \"COL 96\" = HEXTORAW('c104') and \"COL 97\" IS NULL and \"COL 98\" IS NULL and \"COL 99\" IS NULL and \"COL 100\" IS NULL and \"COL 101\" = HEXTORAW('c103') and \"COL 102\" = HEXTORAW('c102') and \"COL 103\" = HEXTORAW('80') and \"COL 104\" = HEXTORAW('c102') and \"COL 105\" IS NULL and \"COL 106\" IS NULL and \"COL 107\" IS NULL and \"COL 108\" IS NULL and \"COL 109\" IS NULL and \"COL 110\" = HEXTORAW('c3295d27') and \"COL 111\" IS NULL and \"COL 112\" = HEXTORAW('c103') and \"COL 113\" IS NULL and \"COL 114\" IS NULL and \"COL 115\" IS NULL an\n" +
					"d \"COL 116\" IS NULL and \"COL 117\" = HEXTORAW('c103') and \"COL 118\" = HEXTORAW('c102') and \"COL 119\" IS NULL and \"COL 120\" IS NULL and \"COL 121\" = HEXTORAW('c105') and \"COL 122\" IS NULL and \"COL 123\" = HEXTORAW('c102') and \"COL 124\" IS NULL and \"COL 125\" IS NULL and \"COL 126\" IS NULL and \"COL 127\" = HEXTORAW('4e') and \"COL 128\" = HEXTORAW('80') and \"COL 129\" = HEXTORAW('80') and \"COL 130\" IS NULL and \"COL 131\" = HEXTORAW('c102') and \"COL 132\" IS NULL and \"COL 133\" = HEXTORAW('42') and \"COL 134\" = HEXTORAW('4e') and \"COL 135\" IS NULL and \"COL 136\" = HEXTORAW('c105') and \"COL 137\" = HEXTORAW('4e') and \"COL 138\" = HEXTORAW('4e') and \"COL 139\" IS NULL and \"COL 140\" = HEXTORAW('4e') and \"COL 141\" = HEXTORAW('59') and \"COL 142\" IS NULL and \"COL 143\" IS NULL and \"COL 144\" IS NULL and \"COL 145\" = HEXTORAW('c102') and \"COL 146\" IS NULL and \"COL 147\" = HEXTORAW('4541') and \"COL 148\" = HEXTORAW('45414348') and \"COL 149\" = HEXTORAW('c104') and \"COL 150\" = HEXTORAW('c3295d2f') and \"COL 151\" = HEXTORAW('c3295d2e') and \"COL 152\" = HEXTORAW('59') and \"COL 153\" = HEXTORAW('494e414354495645') and \"COL 154\" = HEXTORAW('c107') and \"COL 155\" IS NULL and \"COL 156\" = HEXTORAW('c103') and \"COL 157\" IS NULL and \"COL 158\" = HEXTORAW('c102') and \"COL 159\" IS NULL and \"COL 160\" = HEXTORAW('80') and \"COL 161\" IS NULL and \"COL 162\" = HEXTORAW('c11f') and \"COL 163\" IS NULL and \"COL 164\" = HEXTORAW('c215') and \"COL 165\" = HEXTORAW('c102') and \"COL 166\" IS NULL and \"COL 167\" IS NULL and \"COL 168\" IS NULL and \"COL 169\" IS NULL and \"COL 170\" = HEXTORAW('c151') and \"COL 171\" IS NULL and \"COL 172\" = HEXTORAW('c103') and \"COL 173\" IS NULL and \"COL 174\" = HEXTORAW('c102') and \"COL 175\" IS NULL and \"COL 176\" IS NULL and \"COL 177\" IS NULL and \"COL 178\" IS NULL and \"COL 179\" IS NULL and \"COL 180\" IS NULL and \"COL 181\" = HEXTORAW('4e') and \"COL 182\" = HEXTORAW('4e') and \"COL 183\" = HEXTORAW('4e') and \"COL 184\" IS NULL and \"COL 185\" IS NULL and \"COL 186\" = HEXTORAW('4e') and \"COL 187\" IS NULL and \"COL 188\" IS NULL and \"COL 189\" IS NULL and \"COL 190\" IS NULL and \"COL 191\" IS NULL and \"COL 192\" IS NULL and \"COL 193\" = HEXTORAW('4e') and \"COL 194\" IS NULL and \"COL 195\" IS NULL and \"COL 196\" IS NULL and \"COL 197\" IS NULL and \"COL 198\" IS NULL and \"COL 199\" IS NULL and \"COL 200\" IS NULL and \"COL 201\" IS NULL and \"COL 202\" = HEXTORAW('59') and \"COL 203\" IS NULL and \"COL 204\" = HEXTORAW('4e') and \"COL 205\" = HEXTORAW('4e') and \"COL 206\" = HEXTORAW('c5022e455f09') and \"COL 207\" = HEXTORAW('c20502') and \"COL 208\" = HEXTORAW('c3041f2e') and \"COL 209\" = HEXTORAW('787d0c130b2934') and \"COL 210\" = HEXTORAW('4e') and \"COL 211\" IS NULL and \"COL 212\" = HEXTORAW('c20215') and \"COL 213\" IS NULL and \"COL 214\" = HEXTORAW('59') and \"COL 215\" = HEXTORAW('4e') and \"COL 216\" = HEXTORAW('59') and \"COL 217\" = HEXTORAW('50') and \"COL 218\" IS NULL and \"COL 219\" = HEXTORAW('4e') and \"COL 220\" = HEXTORAW('c108') and \"COL 221\" = HEXTORAW('c103') and \"COL 222\" = HEXTORAW('c103') and \"COL 223\" IS NULL and \"COL 224\" IS NULL and \"COL 225\" = HEXTORAW('4e') and \"COL 226\" = HEXTORAW('4e') and \"COL 227\" IS NULL and \"COL 228\" IS NULL and \"COL 229\" IS NULL and \"COL 230\" IS NULL and \"COL 231\" IS NULL and \"COL 232\" IS NULL and \"COL 233\" IS NULL and \"COL 234\" IS NULL and \"COL 235\" IS NULL and \"COL 236\" IS NULL and \"COL 237\" IS NULL and \"COL 238\" IS NULL and \"COL 239\" IS NULL and \"COL 240\" IS NULL and \"COL 241\" IS NULL and \"COL 242\" IS NULL and \"COL 243\" IS NULL and \"COL 244\" IS NULL and \"COL 245\" IS NULL and \"COL 246\" IS NULL and \"COL 247\" = HEXTORAW('c102') and \"COL 248\" = HEXTORAW('4e') and \"COL 249\" IS NULL and \"COL 250\" IS NULL and \"COL 251\" IS NULL and \"COL 252\" IS NULL and \"COL 253\" = HEXTORAW('c103') and \"COL 254\" IS NULL and \"COL 255\" IS NULL and \"COL 256\" IS NULL and \"COL 257\" = HEXTORAW('4e') and \"COL 258\" = HEXTORAW('4e') and \"COL 259\" = HEXTORAW('4e') and \"COL 260\" IS NULL and \"COL 261\" IS NULL and \"COL 262\" IS NULL and \"COL 263\" IS NULL and \"COL 264\" IS NULL and \"COL 265\" IS NULL and \"COL 266\" IS NULL\n" +
					" and \"COL 267\" = HEXTORAW('554e5055424c4953484544') and \"COL 268\" = HEXTORAW('4e') and \"COL 269\" = HEXTORAW('494e') and \"COL 270\" = HEXTORAW('c103') and \"COL 271\" = HEXTORAW('80') and \"COL 272\" = HEXTORAW('c10533') and \"COL 273\" = HEXTORAW('4e') and \"COL 274\" = HEXTORAW('59') and \"COL 275\" = HEXTORAW('c11a') and \"COL 276\" = HEXTORAW('4e') and \"COL 277\" IS NULL and \"COL 278\" = HEXTORAW('59') and \"COL 279\" = HEXTORAW('59') and \"COL 280\" IS NULL and \"COL 281\" IS NULL and \"COL 282\" IS NULL and \"COL 283\" IS NULL and \"COL 284\" IS NULL and \"COL 285\" IS NULL and \"COL 286\" IS NULL and \"COL 287\" IS NULL and \"COL 288\" = HEXTORAW('c102') and \"COL 289\" IS NULL and \"COL 290\" = HEXTORAW('80') and \"COL 291\" = HEXTORAW('80') and \"COL 292\" IS NULL and \"COL 293\" IS NULL and \"COL 294\" IS NULL and \"COL 295\" = HEXTORAW('4e') and \"COL 296\" IS NULL and \"COL 297\" IS NULL and \"COL 298\" = HEXTORAW('59') and \"COL 299\" = HEXTORAW('494e5445524e414c') and \"COL 300\" = HEXTORAW('59') and \"COL 301\" IS NULL and \"COL 302\" IS NULL and \"COL 303\" IS NULL and \"COL 304\" IS NULL and \"COL 305\" IS NULL and \"COL 306\" IS NULL and \"COL 307\" IS NULL and \"COL 308\" IS NULL and \"COL 309\" IS NULL and \"COL 310\" = HEXTORAW('c10b') and \"COL 311\" = HEXTORAW('50') and \"COL 312\" = HEXTORAW('50') and \"COL 313\" IS NULL and \"COL 314\" IS NULL and \"COL 315\" IS NULL and \"COL 316\" IS NULL and \"COL 317\" IS NULL and \"COL 318\" IS NULL and \"COL 319\" IS NULL and \"COL 320\" IS NULL and \"COL 321\" IS NULL and \"COL 322\" = HEXTORAW('c103') and \"COL 323\" = HEXTORAW('c103') and \"COL 324\" = HEXTORAW('c102') and \"COL 325\" IS NULL and \"COL 326\" = HEXTORAW('c103') and \"COL 327\" IS NULL and \"COL 328\" IS NULL and \"COL 329\" IS NULL and \"COL 330\" IS NULL and \"COL 331\" = HEXTORAW('c103') and \"COL 332\" = HEXTORAW('c103') and \"COL 333\" = HEXTORAW('c104') and \"COL 334\" = HEXTORAW('c104') and \"COL 335\" = HEXTORAW('c104') and \"COL 336\" IS NULL and \"COL 337\" IS NULL and \"COL 338\" IS NULL and \"COL 339\" IS NULL and \"COL 340\" IS NULL and \"COL 341\" IS NULL and \"COL 342\" IS NULL and \"COL 343\" IS NULL and \"COL 344\" IS NULL and \"COL 345\" IS NULL and \"COL 346\" IS NULL and \"COL 347\" IS NULL and \"COL 348\" IS NULL and \"COL 349\" IS NULL and \"COL 350\" IS NULL and \"COL 351\" IS NULL and \"COL 352\" IS NULL and \"COL 353\" IS NULL and \"COL 354\" = HEXTORAW('4e') and \"COL 355\" IS NULL and \"COL 356\" IS NULL and \"COL 357\" = HEXTORAW('4e') and \"COL 358\" = HEXTORAW('4e') and \"COL 359\" IS NULL and \"COL 360\" IS NULL and \"COL 361\" IS NULL and \"COL 362\" = HEXTORAW('4e') and \"COL 363\" = HEXTORAW('4e') and \"COL 364\" IS NULL and \"COL 365\" = HEXTORAW('59') and \"COL 366\" IS NULL and \"COL 367\" IS NULL and \"COL 368\" = HEXTORAW('4e') and \"COL 369\" = HEXTORAW('4e') and \"COL 370\" = HEXTORAW('4e') and \"COL 371\" IS NULL and \"COL 372\" IS NULL and \"COL 373\" IS NULL and \"COL 374\" IS NULL and \"COL 375\" = HEXTORAW('4e') and \"COL 376\" IS NULL and \"COL 377\" IS NULL and \"COL 378\" IS NULL and \"COL 379\" IS NULL and \"COL 380\" = HEXTORAW('4e') and \"COL 381\" = HEXTORAW('c104') and \"COL 382\" IS NULL and \"COL 383\" = HEXTORAW('c103') and \"COL 384\" IS NULL and \"COL 385\" = HEXTORAW('4e') and \"COL 386\" IS NULL and \"COL 387\" IS NULL and \"COL 388\" IS NULL and \"COL 389\" IS NULL and \"COL 390\" IS NULL and \"COL 391\" IS NULL and \"COL 392\" IS NULL and \"COL 393\" IS NULL and \"COL 394\" IS NULL and \"COL 395\" IS NULL and \"COL 396\" IS NULL and \"COL 397\" IS NULL and \"COL 398\" IS NULL and \"COL 399\" IS NULL and \"COL 400\" IS NULL and \"COL 401\" = HEXTORAW('4e') and \"COL 402\" = HEXTORAW('44454641554c544942') and \"COL 403\" IS NULL and \"COL 404\" = HEXTORAW('c102') and \"COL 405\" IS NULL\n";
			assertTrue(compareLogMinerText(lmStatement, stmt.getSqlRedo()));

			assertFalse(transaction.getStatement(stmt));

		} catch(IOException | SQLException e) {}
	}

	@Test
	public void reverseOrderMtlSystemItemsInterface() {

		var orl = OraCdcRedoLog.getLinux19c();

		/*
		 * SCN:6107320386484, RBA:0x004366.00e86c51.0010, OP:5.1 fb:-----L--, supp fb:-----L--, OP:11.5 fb:-----L--
		 */
		var baUpdate1 = hexToRaw("9C010000057C8D05B483A9F80300000007D7CD5100000000000002005E0000005B0100000A0004002283A9F88D050000D980A9F88D0500003984A9F88D0500009CC6BB4805021B001500FFFFD00040038983A9F88D0500000100FFFF0300000000000000040020001D00000000000000FAF94303B93701000A007C00DBCD6E06000000000000000005011C001500FFFFFAF94303B483A9F88D0500000101FFFF030000000000000010001400180010001D00020002001C007C00FEFF0A00000006001D003B582F00B93701A6C6A40200C6A4020007000000F9F943030B011D0000003B58020DA1530C000000F9F94303B9374800377EFE032210C0037D09250101000000040149000600FF0100000000000400002D00E600C12E0000010400001B00E600E60000000010000000000000377EFE03070000000B05010019000200377EFE03B483A9F88D0500000200C6A403000000000000000A0010001D00020002001000020D1D491D7F0000FAF94303B9370100377EFE032210C0037D09050101000000040149000600FF0100000000000000002D008D05C12FA9F8");
		var rrUpdate1 = new OraCdcRedoRecord(orl, 0x0000058df8a983b4l, "0x004366.00e86c51.0010", baUpdate1);
		assertTrue(rrUpdate1.has5_1());
		assertTrue(rrUpdate1.change5_1().supplementalLogData());
		assertTrue(rrUpdate1.change5_1().supplementalFb() != 0);
		assertTrue(rrUpdate1.change5_1().fb() != 0);
		assertFalse(rrUpdate1.has10_x());
		assertTrue(rrUpdate1.has11_x());
		assertEquals(rrUpdate1.change11_x().operation, _11_5_URP);
		assertTrue(rrUpdate1.change11_x().fb() != 0);

		/*
		 * SCN:6107320386484, RBA:0x004366.00e86d74.0084, OP:5.1 fb:--H-F---, supp fb:----F---, OP:11.5 fb:--H-F---
		 */
		var baUpdate2 = hexToRaw("3801000001008D05B483A9F80200000007D7CD510000303305011C001500FFFFF9F94303B483A9F88D0500000100FFFF030000000000000012001400180010001D000400020004001C00A153800080002200000006001D003B582F00B93748A6C6A40200C6A4020007000000000000000B011D4700003B58020DA1530C000000F9F94303B9374700377EFE032210C0037D09250101000000280149000700B8020000000000000000930094004541000045414348010800001B009400940000000010000040000000377EFE03070000000B05010019000200377EFE03B483A9F88D0500000100C6A403000000000000000C0010001D00040002000400020D1D491D7F0000F9F94303B9374800377EFE032210C0037D09050101000000280149000700B8020000000000000000930094004541000045414348");
		var rrUpdate2 = new OraCdcRedoRecord(orl, 0x0000058df8a983b4l, "0x004366.00e86d74.0084", baUpdate2);
		assertTrue(rrUpdate2.has5_1());
		assertTrue(rrUpdate2.change5_1().supplementalLogData());
		assertTrue(rrUpdate2.change5_1().supplementalFb() != 0);
		assertTrue(rrUpdate2.change5_1().fb() != 0);
		assertFalse(rrUpdate2.has10_x());
		assertTrue(rrUpdate2.has11_x());
		assertEquals(rrUpdate2.change11_x().operation, _11_5_URP);
		assertTrue(rrUpdate2.change11_x().fb() != 0);

		assertEquals(rrUpdate1.halfDoneKey(), rrUpdate2.halfDoneKey());

		var raw = new OraCdcRawTransaction(new Xid((short)0x6, (short)0x1d, 0x2f583b), ZoneId.systemDefault(), 0x10, new OraCdcLobExtras());
		try {
			raw.add(rrUpdate1, (int)(System.currentTimeMillis() / 1000));
			raw.add(rrUpdate2, (int)(System.currentTimeMillis() / 1000));
			raw.commitScn(0x0000058df8aa6d80l);
			var transaction = new OraCdcTransactionArrayList(raw, orl.cdb(), REDOMINER, Path.of(System.getProperty("java.io.tmpdir")));
			var stmt = new OraCdcRedoMinerStatement();

			assertTrue(transaction.completed());

			assertTrue(transaction.getStatement(stmt));
			assertEquals(stmt.getOperation(), UPDATE);
			assertEquals(stmt.getRba(), rrUpdate2.rba());
			assertEquals(stmt.getRowId().toString(), "AAAqTGAAPAAPn43AAH");
			System.out.println(stmt);
			final String lmUpd1 =
					"update \"UNKNOWN\".\"OBJ# 173254\" set \"COL 148\" = HEXTORAW('4541'), \"COL 149\" = HEXTORAW('45414348'), \"COL 230\" = HEXTORAW('c12f') where \"COL 148\" = HEXTORAW('4541') and \"COL 149\" = HEXTORAW('45414348') and \"COL 230\" = HEXTORAW('c12e')";
			assertTrue(compareLogMinerText(lmUpd1, stmt.getSqlRedo()));


		} catch(IOException | SQLException e) {}
	}

	@Test
	public void homegeneousMtlSystemItemsInterface() {

		var orl = OraCdcRedoLog.getLinux19c();

		/*
		 * SCN:6107320443805, RBA:0x004366.00ec5423.0148, OP:5.1 fb:----F---, supp fb:----F---, OP:11.5 fb:----F---
		 */
		var baUpdate1 = hexToRaw("7001000001058D059D63AAF8E500000307D7CD510000000005011C005500FFFF55C444159D63AAF88D0500001E00FFFF03000000000000001C001400180010001D000E0000000000000000000000000000001C00900008052200000006001D003B582F00C0371E22C6A40200C6A4020007000000000000000B011D1D00003B58020D00000000000055C44415C03718004C7FFE032210C0037D09250103000000080300000100A007F9FF7F0000001C003B003C003D003F004000410042002F00010800001B003C003C00000000100000000000009A052F040B0000000B050100190002004C7FFE039D63AAF88D0500000700C6A40300000000000000160010001D000E0001000100010001000100010001000000020DFE039D63AAF855C44415C0371E004C7FFE032210C0037D09050103000000080300000100A00707000000000500003B003C003D003F0040004100420010004E0002004E0010004E0D6B484E7F00004EEC8215593720004E7CFE03");
		var rrUpdate1 = new OraCdcRedoRecord(orl, 0x0000058df8aa639dl, "0x004366.00ec5423.0148", baUpdate1);
		assertTrue(rrUpdate1.has5_1());
		assertTrue(rrUpdate1.change5_1().supplementalLogData());
		assertTrue(rrUpdate1.change5_1().supplementalFb() != 0);
		assertTrue(rrUpdate1.change5_1().fb() != 0);
		assertFalse(rrUpdate1.has10_x());
		assertTrue(rrUpdate1.has11_x());
		assertEquals(rrUpdate1.change11_x().operation, _11_5_URP);
		assertTrue(rrUpdate1.change11_x().fb() != 0);

		/*
		 * SCN:6107320443805, RBA:0x004366.00ec5424.00c8, OP:5.1 fb:-----L--, supp fb:-----L--, OP:11.5 fb:-----L--
		 */
		var baUpdate2 = hexToRaw("4001000001098D059D63AAF8E600000007D7CD510000000005011C005500FFFF55C444159D63AAF88D0500001F00FFFF030000000000000014001400180010001D0006000000000000001C00800076042200000006001D003B582F00C0371F22C6A40200C6A4020007000000000000000B011D1E00003B58020D00000000000055C44415C0371E004C7FFE032210C0037D09250103000000040300000200FF03FDFF0700003720001400CD00D300C003010400001B00CD00CD00000000100000000000009A052F040B0000000B050100190002004C7FFE039D63AAF88D0500000800C6A403000000000000000E0010001D000600010001000100AAF8020D6B481D7F000055C44415C0371F004C7FFE032210C0037D09050103000000040300000200FF0303000000007CFE031400CD00D30005014E0000004E0100004E00FF01");
		var rrUpdate2 = new OraCdcRedoRecord(orl, 0x0000058df8aa639dl, "0x004366.00ec5424.00c8", baUpdate2);
		assertTrue(rrUpdate2.has5_1());
		assertTrue(rrUpdate2.change5_1().supplementalLogData());
		assertTrue(rrUpdate2.change5_1().supplementalFb() != 0);
		assertTrue(rrUpdate2.change5_1().fb() != 0);
		assertFalse(rrUpdate2.has10_x());
		assertTrue(rrUpdate2.has11_x());
		assertEquals(rrUpdate2.change11_x().operation, _11_5_URP);
		assertTrue(rrUpdate2.change11_x().fb() != 0);

		assertEquals(rrUpdate1.halfDoneKey(), rrUpdate2.halfDoneKey());

		var raw = new OraCdcRawTransaction(new Xid((short)0x6, (short)0x1d, 0x2f583b), ZoneId.systemDefault(), 0x10, new OraCdcLobExtras());
		try {
			raw.add(rrUpdate1, (int)(System.currentTimeMillis() / 1000));
			raw.add(rrUpdate2, (int)(System.currentTimeMillis() / 1000));
			raw.commitScn(0x0000058df8aa6d80l);
			var transaction = new OraCdcTransactionArrayList(raw, orl.cdb(), REDOMINER, Path.of(System.getProperty("java.io.tmpdir")));
			var stmt = new OraCdcRedoMinerStatement();

			assertTrue(transaction.completed());

			assertTrue(transaction.getStatement(stmt));
			assertEquals(stmt.getOperation(), UPDATE);
			assertEquals(stmt.getRba(), rrUpdate1.rba());
			assertEquals(stmt.getRowId().toString(), "AAAqTGAAQAALwWaAAL");
			System.out.println(stmt);
			final String lmUpd1 =
					"update \"UNKNOWN\".\"OBJ# 173254\" set \"COL 60\" = HEXTORAW('4e'), \"COL 61\" = HEXTORAW('4e'), \"COL 62\" = HEXTORAW('4e'), \"COL 64\" = HEXTORAW('4e'), \"COL 65\" = HEXTORAW('4e'), \"COL 66\" = HEXTORAW('59'), \"COL 67\" = HEXTORAW('4e'), \"COL 205\" = HEXTORAW('4e'), \"COL 390\" = HEXTORAW('4e'), \"COL 396\" = HEXTORAW('4e') where \"COL 60\" IS NULL and \"COL 61\" IS NULL and \"COL 62\" IS NULL and \"COL 64\" IS NULL and \"COL 65\" IS NULL and \"COL 66\" IS NULL and \"COL 67\" IS NULL and \"COL 205\" IS NULL and \"COL 390\" IS NULL and \"COL 396\" IS NULL";
			assertTrue(compareLogMinerText(lmUpd1, stmt.getSqlRedo()));


		} catch(IOException | SQLException e) {}
	}

	@Test
	public void homegeneousMtlMaterialTransactionsReverse() {

		var orl = OraCdcRedoLog.getLinux19c();

		/*
		 * SCN:6108055261942, RBA:0x004458.00f64d89.00d0, OP:5.1 fb:--H-FL--, supp fb:-C-DFL--, OP:11.5 fb:--H-FL--
		 */
		var baUpdate1 = hexToRaw("7806000001A28E05F6D276240600000007D7CD510000000005011A015600FFFF5CCD8115F6D276248E0500000300FFFF03000000000000006E011400180010001E00120006000300040007000100060002000000000014004A014A0106000700010007000300060005000000030003000400020002000200050000000400020004000700040004000000000005000000000005000000020003000300030002000100070000000100000000000000000000000000000000000000000000000000000006000500000000000000030005000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000020000000300020003000200030002000300020000000000000000000000020000000000000000000000000000000000000000000000000000000100000000008C05CE1122000000850012005E231100A9940D1600A5020000A502000E000000000000000B01120C00005E23020D0000000000005CCD8115A99401001EDFFD0832B5C4087D092501050000002C0500000000AD0906008001000000000600070008000900200021002300680069002100C5022F4E501D0000C2080300C3042622787E01140B2B20154E481000C504054D37600000C2047624015CA500170007000700000000100000000000000100020003000400050006000B000C000D000E000F0010001100120013001400150016001700180019001A001B001C001D001E001F0020002300250026002700280029002A002B002C002D002E002F0030003100320033003400350036003700380039003A003B003C003D003E003F0040004100420043004400450046004700480049004A004B004C004D004E004F0050005100520053005400550056005700580059005A005B005C005D005E005F006000610062006300640065006600670068006B006C006D006E006F0070007100720073007400750076007700780079007A007B007C007D007E007F0080008100820083008400850086008700880089008A008B008C008D008E008F0090009100920093009400950096009700980099009A009B009C009D009E009F00A000A100A200A300A400A500A600A700A800A900AA00AB00AC00AD00AE0001050600070001000700030006000500FFFF0300030004000200020002000500FFFF040002000400070004000400FFFFFFFF0500FFFFFFFF0500FFFF0200030003000300020001000700FFFF0100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF06000500FFFFFFFFFFFF03000500FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0400FFFFFFFFFFFFFFFFFFFFFFFF0300FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0200FFFF03000200030002000300020003000200FFFFFFFFFFFFFFFFFFFF0200FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0100FFFF0000C504054D35300000787E01140B2B200080000000787E01140B2A0400C2154F00C5022B2C080A0000C4040E463D497624C2083E0043504951C3163624C1130100C11C0000C1020000C41203091C497624C20217444B477624C2021744787E01140B2A0300C21F434CC31E2941C4032B5E07EC5D03C40F1E2F15050000C204FFFFC2034C00C2034C0055534400C102000030000000787D081C0101011580641E00C504054D352E0000C41A18010C00000052435651C41A18010C00FFFFC3023D024E455724C1030000C2083EFFC1030000C2083E00C1031400C2083E00C1030200C2083E00C1036C12C1020000800019000B050100300002001EDFFD08F3D276248E050000010000A503000000000000001A0010001E001200060003000400070000000000030000000000800D020D0000000000005CCD8115A9940D001EDFFD0832B5C4087D090501050000002C0500000000AD09FAFFB001000015000600070008000900200021002300680069002501C5022F4E50530000C2080301C3042623787E01140B2B2300C2034C00");
		var rrUpdate1 = new OraCdcRedoRecord(orl, 0x0000058e2476d2f6l, "0x004458.00f64d89.00d0", baUpdate1);
		assertTrue(rrUpdate1.has5_1());
		assertTrue(rrUpdate1.change5_1().supplementalLogData());
		assertTrue(rrUpdate1.change5_1().supplementalFb() != 0);
		assertTrue(rrUpdate1.change5_1().fb() != 0);
		assertFalse(rrUpdate1.has10_x());
		assertTrue(rrUpdate1.has11_x());
		assertEquals(rrUpdate1.change11_x().operation, _11_5_URP);
		assertTrue(rrUpdate1.change11_x().fb() != 0);

		/*
		 * SCN:6108055261939, RBA:0x004458.00f64d9b.00b4, OP:5.1 fb:--H-FL--, supp fb:-C-DFL--, OP:11.5 fb:--H-FL--
		 */
		var baUpdate2 = hexToRaw("9006000001328E05F3D276240100001707D7CD5100000400050219011500FFFF10D05A03E8D276248E0500000100FFFF0300000000000000040020001200E97A000000005CCD8115A99401000A00980500000000000000000000000005011A015600FFFF5CCD8115F3D276248E0500000101FFFF03000000000000006E011400180010001D000200000014005A015A01060007000100070003000600060003000400070005000000030003000400020002000200050000000400020004000700040000000000050000000000050001000600000002000200030003000300020001000700000001000000000000000000000000000000000000000000000000000000060005000000000000000300050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000000002000000030002000300020003000200030002000000000000000000000002000000000000000000000000000000000000000000000000000000010000000000980558000A000000850012005E231100A994010000A5020000A502000E0000005BCD81150B01120000005E23020D0000000000005BCD8115A9941E001EDFFD0832B5C4087D092501050000002C0500000000AD01FCFF010000110F0018000000015CAD00170019001900000000100000000000000100020003000400050006000700080009000A000B000C000D000E000F001000110012001300140015001600170018001A001B001C001D001E001F0020002100220023002400250026002700280029002A002B002C002D002E002F0030003100320033003400350036003700380039003A003B003C003D003E003F0040004100420043004400450046004700480049004A004B004C004D004E004F0050005100520053005400550056005700580059005A005B005C005D005E005F0060006100620063006400650066006700680069006A006B006C006D006E006F0070007100720073007400750076007700780079007A007B007C007D007E007F0080008100820083008400850086008700880089008A008B008C008D008E008F0090009100920093009400950096009700980099009A009B009C009D009E009F00A000A100A200A300A400A500A600A700A800A900AA00AB00AC00AD00AE00000006000700010007000300060006000300040007000500FFFF0300030004000200020002000500FFFF04000200040007000400FFFFFFFF0500FFFFFFFF050001000600FFFF02000200030003000300020001000700FFFF0100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF06000500FFFFFFFFFFFF03000500FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0400FFFFFFFFFFFFFFFFFFFFFFFF0300FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0200FFFF03000200030002000300020003000200FFFFFFFFFFFFFFFFFFFF0200FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0100FFFF0066C504054D35300074787E01140B2B20768065006E787E01140B2A0461C2154F65C5022B2C080A0061C5022F4E501D002EC2080370C3042622787E01140B2B2074C4040E463D690070C2083E7343504961C3163624C1130063C11C0061C1020067C41203091C750070C20217444B470065C2021744787E01140B2A036EC31E2941C4032B5E076D0065C40F1E2F156500764E65006EC504054D37600065C204003EC2040038C2034C39C2034C3755534432C102002F30650076787D081C0101015F806B0065C504054D352E002FC41A18010C6600615243566CC41A18010C010000C3023D024E455724C1030000C2083E51C1030900C2083E00C103FFFFC2083E15C1037224C2083E00C103FFFFC1020000800000000B050100300002001EDFFD08E8D276248E050000010000A503000000000000000A0010001D00020004000000020D800DD0B803005CCD8115A99401001EDFFD0832B5C4087D090501050000002C0500000000AD010400000000DCEC0A1800C408C21F434C");
		var rrUpdate2 = new OraCdcRedoRecord(orl, 0x0000058e2476d2f3l, "0x004458.00f64d9b.00b4", baUpdate2);
		assertTrue(rrUpdate2.has5_1());
		assertTrue(rrUpdate2.change5_1().supplementalLogData());
		assertTrue(rrUpdate2.change5_1().supplementalFb() != 0);
		assertTrue(rrUpdate2.change5_1().fb() != 0);
		assertFalse(rrUpdate2.has10_x());
		assertTrue(rrUpdate2.has11_x());
		assertEquals(rrUpdate2.change11_x().operation, _11_5_URP);
		assertTrue(rrUpdate2.change11_x().fb() != 0);

		/*
		 * SCN:6108055261928, RBA:0x004458.00f64d40.0144, OP:5.1 fb:--H-FL--, supp fb:-C-DFL--, OP:11.5 fb:--H-FL--
		 */
		var baUpdate3 = hexToRaw("6C07000001008E05E8D276240300000007D7CD5100000000050219011500FFFF10D05A0362D076248E0500000100FFFF03000000000000000600200004000000120005025E2311005BCD8115A9941E005200C005007F0000000000000000000007D7CD5105011A015600FFFF5BCD811561D076248E0500000200FFFF03000000000000006E0114004C0008001D0006000500030003001400560156010600070001000700030006000600030004000700050000000300030004000200020002000500000004000200040007000000040000000000050000000000010006000000020002000300020001000700000001000000000000000000000000000000000000000000000000000000060005000000000000000300050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000000002000000030002000300020003000200030002000000000000000000000002000000000000000000000000000000000000000000000000000000010000000000C0057C0D12000000850012005E231100A9941EBB00A5020000A502000E000000000000000B011200080C0100000000005BCD8115A9941900709876248E0500000D9976248E05000000000000FFFFFFFFFFFFFFFF59CD811500000000EA000000030D0000000000001EDFFD0832B5C4087D092501050000002C0000000000AD0300000000000000001F00250026000000C40F1E2F15000000C2034C00C2034C00015CAB00170020002000000000100000400000000100020003000400050006000700080009000A000B000C000D000E000F0010001100120013001400150016001700180019001A001B001C001D001E001F0021002200230024002500280029002A002B002C002D002E002F0030003100320033003400350036003700380039003A003B003C003D003E003F0040004100420043004400450046004700480049004A004B004C004D004E004F0050005100520053005400550056005700580059005A005B005C005D005E005F0060006100620063006400650066006700680069006A006B006C006D006E006F0070007100720073007400750076007700780079007A007B007C007D007E007F0080008100820083008400850086008700880089008A008B008C008D008E008F0090009100920093009400950096009700980099009A009B009C009D009E009F00A000A100A200A300A400A500A600A700A800A900AA00AB00AC00AD00AE00000006000700010007000300060006000300040007000500FFFF0300030004000200020002000500FFFF0400020004000700FFFF0400FFFFFFFF0500FFFFFFFF01000600FFFF020002000300020001000700FFFF0100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF06000500FFFFFFFFFFFF03000500FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0400FFFFFFFFFFFFFFFFFFFFFFFF0300FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0200FFFF03000200030002000300020003000200FFFFFFFFFFFFFFFFFFFF0200FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0100FFFF0000C504054D35304B27787E01140B2B200080D28115787E01140B2A040AC2154F08C5022B2C080A0000C5022F4E501D8701C2080300C3042622787E01140B2B2000C4040E463D000000C2083E0F43504900C3163624C1130200C11C570AC1027624C41203091C009CA0C20217444B470000C2021744787E01140B2A0300C31E2941C4032B5E07D281154E900900C504054D3760C408C2040501C204000055534400C102870130000000787D081C0101014280054B50C504054D352E8E05C41A18010C00000052435651C41A18010C010100C3023D024E45570EC1037624C2083E00C103D5C1C2083E00C1030000C2083E00C1030D00C2083E24C1038E05C1020080804676240B050100300002001EDFFD0896A576248E050000010200A503000000000000000E0050001D0006000500030003000000110D800DD0B80300850012005E2311005BCD8115A9941E00840000000000000000000000000000000000000002020D7AE8D2762400808E05030600809DA476240406008096A576248E058E05000000001EDFFD0832B5C4087D090501050000002C0500000000AD03000000000092C4081F00250026000000C40F1E2F15008702C2034C00C2034C0005140000000000000000000000000000000000000006726503000000000000001200080000000600040004000000080004002C63000060858E0B000000000100000007000000001368E3B01F53595341444D494E41505053");
		var rrUpdate3 = new OraCdcRedoRecord(orl, 0x0000058e2476d2e8l, "0x004458.00f64d40.0144", baUpdate3);
		assertTrue(rrUpdate3.has5_1());
		assertTrue(rrUpdate3.change5_1().supplementalLogData());
		assertTrue(rrUpdate3.change5_1().supplementalFb() != 0);
		assertTrue(rrUpdate3.change5_1().fb() != 0);
		assertFalse(rrUpdate3.has10_x());
		assertTrue(rrUpdate3.has11_x());
		assertEquals(rrUpdate3.change11_x().operation, _11_5_URP);
		assertTrue(rrUpdate3.change11_x().fb() != 0);

		assertEquals(rrUpdate1.halfDoneKey(), rrUpdate2.halfDoneKey());
		assertEquals(rrUpdate1.halfDoneKey(), rrUpdate3.halfDoneKey());

		var raw = new OraCdcRawTransaction(new Xid((short)0x85, (short)0x12, 0x11235e), ZoneId.systemDefault(), 0x10, new OraCdcLobExtras());
		try {
			raw.add(rrUpdate1, (int)(System.currentTimeMillis() / 1000));
			raw.add(rrUpdate2, (int)(System.currentTimeMillis() / 1000));
			raw.add(rrUpdate3, (int)(System.currentTimeMillis() / 1000));
			raw.commitScn(0x0000058e2476d2f8l);
			var transaction = new OraCdcTransactionArrayList(raw, orl.cdb(), REDOMINER, Path.of(System.getProperty("java.io.tmpdir")));
			var stmt = new OraCdcRedoMinerStatement();

			assertTrue(transaction.completed());

			assertTrue(transaction.getStatement(stmt));
			assertEquals(stmt.getOperation(), UPDATE);
			assertEquals(stmt.getRba(), rrUpdate3.rba());
			assertEquals(stmt.getScn(), rrUpdate3.scn());
			assertEquals(stmt.getRowId().toString(), "AAAqUAAAjAAPd8eAAA");
			System.out.println(stmt);
			final String lmUpd1 =
					"update \"UNKNOWN\".\"OBJ# 173312\" set \"COL 32\" = HEXTORAW('c40f1e2f15'), \"COL 38\" = HEXTORAW('c2034c'), \"COL 39\" = HEXTORAW('c2034c') where \"COL 1\" = HEXTORAW('c504054d3530') and \"COL 2\" = HEXTORAW('787e01140b2b20') and \"COL 3\" = HEXTORAW('80') and \"COL 4\" = HEXTORAW('787e01140b2a04') and \"COL 5\" = HEXTORAW('c2154f') and \"COL 6\" = HEXTORAW('c5022b2c080a') and \"COL 7\" = HEXTORAW('c5022f4e501d') and \"COL 8\" = HEXTORAW('c20803') and \"COL 9\" = HEXTORAW('c3042622') and \"COL 10\" = HEXTORAW('787e01140b2b20') and \"COL 11\" = HEXTORAW('c4040e463d') and \"COL 12\" IS NULL and \"COL 13\" = HEXTORAW('c2083e') and \"COL 14\" = HEXTORAW('435049') and \"COL 15\" = HEXTORAW('c3163624') and \"COL 16\" = HEXTORAW('c113') and \"COL 17\" = HEXTORAW('c11c') and \"COL 18\" = HEXTORAW('c102') and \"COL 19\" = HEXTORAW('c41203091c') and \"COL 20\" IS NULL and \"COL 21\" = HEXTORAW('c2021744') and \"COL 22\" = HEXTORAW('4b47') and \"COL 23\" = HEXTORAW('c2021744') and \"COL 24\" = HEXTORAW('787e01140b2a03') and \"COL 25\" IS NULL and \"COL 26\" = HEXTORAW('c31e2941') and \"COL 27\" IS NULL and \"COL 28\" IS NULL and \"COL 29\" = HEXTORAW('c4032b5e07') and \"COL 30\" IS NULL and \"COL 31\" IS NULL and \"COL 32\" = HEXTORAW('c40f1e2f15') and \"COL 33\" = HEXTORAW('4e') and \"COL 34\" = HEXTORAW('c504054d3760') and \"COL 35\" IS NULL and \"COL 36\" = HEXTORAW('c204') and \"COL 37\" = HEXTORAW('c204') and \"COL 38\" = HEXTORAW('c2034c') and \"COL 39\" = HEXTORAW('c2034c') and \"COL 40\" = HEXTORAW('555344') and \"COL 41\" = HEXTORAW('c102') and \"COL 42\" = HEXTORAW('30') and \"COL 43\" = HEXTORAW('787d081c010101') and \"COL 44\" IS NULL and \"COL 45\" = HEXTORAW('80') and \"COL 46\" IS NULL and \"COL 47\" IS NULL and \"COL 48\" IS NULL and \"COL 49\" IS NULL and \"COL 50\" IS NULL and \"COL 51\" IS NULL and \"COL 52\" IS NULL and \"COL 53\" IS NULL and \"COL 54\" IS NULL and \"COL 55\" IS NULL and \"COL 56\" IS NULL and \"COL 57\" IS NULL and \"COL 58\" IS NULL and \"COL 59\" = HEXTORAW('c504054d352e') and \"COL 60\" = HEXTORAW('c41a18010c') and \"COL 61\" IS NULL and \"COL 62\" IS NULL and \"COL 63\" IS NULL and \"COL 64\" = HEXTORAW('524356') and \"COL 65\" = HEXTORAW('c41a18010c') and \"COL 66\" IS NULL and \"COL 67\" IS NULL and \"COL 68\" IS NULL and \"COL 69\" IS NULL and \"COL 70\" IS NULL and \"COL 71\" IS NULL and \"COL 72\" IS NULL and \"COL 73\" IS NULL and \"COL 74\" IS NULL and \"COL 75\" IS NULL and \"COL 76\" IS NULL and \"COL 77\" IS NULL and \"COL 78\" IS NULL and \"COL 79\" IS NULL and \"COL 80\" IS NULL and \"COL 81\" IS NULL and \"COL 82\" IS NULL and \"COL 83\" IS NULL and \"COL 84\" IS NULL and \"COL 85\" IS NULL and \"COL 86\" IS NULL and \"COL 87\" IS NULL and \"COL 88\" IS NULL and \"COL 89\" IS NULL and \"COL 90\" IS NULL and \"COL 91\" IS NULL and \"COL 92\" IS NULL and \"COL 93\" IS NULL and \"COL 94\" IS NULL and \"COL 95\" IS NULL and \"COL 96\" IS NULL and \"COL 97\" IS NULL and \"COL 98\" IS NULL and \"COL 99\" IS NULL and \"COL 100\" IS NULL and \"COL 101\" IS NULL and \"COL 102\" IS NULL and \"COL 103\" IS NULL and \"COL 104\" IS NULL and \"COL 105\" IS NULL and \"COL 106\" IS NULL and \"COL 107\" IS NULL and \"COL 108\" IS NULL and \"COL 109\" IS NULL and \"COL 110\" IS NULL and \"COL 111\" IS NULL and \"COL 112\" IS NULL and \"COL 113\" IS NULL and \"COL 114\" IS NULL and \"COL 115\" IS NULL and \"COL 116\" IS NULL and \"COL 117\" IS NULL and \"COL 118\" IS NULL and \"COL 119\" = HEXTORAW('c3023d02') and \"COL 120\" IS NULL and \"COL 121\" IS NULL and \"COL 122\" IS NULL and \"COL 123\" IS NULL and \"COL 124\" IS NULL and \"COL 125\" IS NULL and \"COL 126\" = HEXTORAW('4e4557') and \"COL 127\" IS NULL and \"COL 128\" IS NULL and \"COL 129\" IS NULL and \"COL 130\" IS NULL and \"COL 131\" IS NULL and \"COL 132\" IS NULL and \"COL 133\" IS NULL and \"COL 134\" IS NULL and \"COL 135\" IS NULL and \"COL 136\" IS NULL and \"COL 137\" IS NULL and \"COL 138\" IS NULL and \"COL 139\" IS NULL and \"COL 140\" IS NULL and \"COL 141\" IS NULL and \"COL 142\" IS NULL and \"COL 143\" IS NULL and \"COL 144\" = HEXTORAW('c103') and \"COL 145\" IS NULL and \"COL 146\" = HEXTORAW('c2083e') and \"COL 147\" = HEXTORAW('c103') and \"COL 148\" = HEXTORAW('c2083e') and \"COL 149\" = HEXTORAW('c103') and \"COL 150\" = " +
					"HEXTORAW('c2083e') and \"COL 151\" = HEXTORAW('c103') and \"COL 152\" = HEXTORAW('c2083e') and \"COL 153\" = HEXTORAW('c103') and \"COL 154\" IS NULL and \"COL 155\" IS NULL and \"COL 156\" IS NULL and \"COL 157\" IS NULL and \"COL 158\" IS NULL and \"COL 159\" = HEXTORAW('c102') and \"COL 160\" IS NULL and \"COL 161\" IS NULL and \"COL 162\" IS NULL and \"COL 163\" IS NULL and \"COL 164\" IS NULL and \"COL 165\" IS NULL and \"COL 166\" IS NULL and \"COL 167\" IS NULL and \"COL 168\" IS NULL and \"COL 169\" IS NULL and \"COL 170\" IS NULL and \"COL 171\" IS NULL and \"COL 172\" IS NULL and \"COL 173\" = HEXTORAW('80') and \"COL 174\" IS NULL";
			assertTrue(compareLogMinerText(lmUpd1, stmt.getSqlRedo()));

			assertTrue(transaction.getStatement(stmt));
			assertEquals(stmt.getOperation(), UPDATE);
			assertEquals(stmt.getRba(), rrUpdate2.rba());
			assertEquals(stmt.getScn(), rrUpdate2.scn());
			assertEquals(stmt.getRowId().toString(), "AAAqUAAAjAAPd8eAAA");
			System.out.println(stmt);
			final String lmUpd2 =
					"update \"UNKNOWN\".\"OBJ# 173312\" set \"COL 25\" = HEXTORAW('c21f434c') where \"COL 1\" = HEXTORAW('c504054d3530') and \"COL 2\" = HEXTORAW('787e01140b2b20') and \"COL 3\" = HEXTORAW('80') and \"COL 4\" = HEXTORAW('787e01140b2a04') and \"COL 5\" = HEXTORAW('c2154f') and \"COL 6\" = HEXTORAW('c5022b2c080a') and \"COL 7\" = HEXTORAW('c5022f4e501d') and \"COL 8\" = HEXTORAW('c20803') and \"COL 9\" = HEXTORAW('c3042622') and \"COL 10\" = HEXTORAW('787e01140b2b20') and \"COL 11\" = HEXTORAW('c4040e463d') and \"COL 12\" IS NULL and \"COL 13\" = HEXTORAW('c2083e') and \"COL 14\" = HEXTORAW('435049') and \"COL 15\" = HEXTORAW('c3163624') and \"COL 16\" = HEXTORAW('c113') and \"COL 17\" = HEXTORAW('c11c') and \"COL 18\" = HEXTORAW('c102') and \"COL 19\" = HEXTORAW('c41203091c') and \"COL 20\" IS NULL and \"COL 21\" = HEXTORAW('c2021744') and \"COL 22\" = HEXTORAW('4b47') and \"COL 23\" = HEXTORAW('c2021744') and \"COL 24\" = HEXTORAW('787e01140b2a03') and \"COL 25\" IS NULL and \"COL 26\" = HEXTORAW('c31e2941') and \"COL 27\" IS NULL and \"COL 28\" IS NULL and \"COL 29\" = HEXTORAW('c4032b5e07') and \"COL 30\" IS NULL and \"COL 31\" IS NULL and \"COL 32\" = HEXTORAW('c40f1e2f15') and \"COL 33\" = HEXTORAW('4e') and \"COL 34\" = HEXTORAW('c504054d3760') and \"COL 35\" IS NULL and \"COL 36\" = HEXTORAW('c204') and \"COL 37\" = HEXTORAW('c204') and \"COL 38\" = HEXTORAW('c2034c') and \"COL 39\" = HEXTORAW('c2034c') and \"COL 40\" = HEXTORAW('555344') and \"COL 41\" = HEXTORAW('c102') and \"COL 42\" = HEXTORAW('30') and \"COL 43\" = HEXTORAW('787d081c010101') and \"COL 44\" IS NULL and \"COL 45\" = HEXTORAW('80') and \"COL 46\" IS NULL and \"COL 47\" IS NULL and \"COL 48\" IS NULL and \"COL 49\" IS NULL and \"COL 50\" IS NULL and \"COL 51\" IS NULL and \"COL 52\" IS NULL and \"COL 53\" IS NULL and \"COL 54\" IS NULL and \"COL 55\" IS NULL and \"COL 56\" IS NULL and \"COL 57\" IS NULL and \"COL 58\" IS NULL and \"COL 59\" = HEXTORAW('c504054d352e') and \"COL 60\" = HEXTORAW('c41a18010c') and \"COL 61\" IS NULL and \"COL 62\" IS NULL and \"COL 63\" IS NULL and \"COL 64\" = HEXTORAW('524356') and \"COL 65\" = HEXTORAW('c41a18010c') and \"COL 66\" IS NULL and \"COL 67\" IS NULL and \"COL 68\" IS NULL and \"COL 69\" IS NULL and \"COL 70\" IS NULL and \"COL 71\" IS NULL and \"COL 72\" IS NULL and \"COL 73\" IS NULL and \"COL 74\" IS NULL and \"COL 75\" IS NULL and \"COL 76\" IS NULL and \"COL 77\" IS NULL and \"COL 78\" IS NULL and \"COL 79\" IS NULL and \"COL 80\" IS NULL and \"COL 81\" IS NULL and \"COL 82\" IS NULL and \"COL 83\" IS NULL and \"COL 84\" IS NULL and \"COL 85\" IS NULL and \"COL 86\" IS NULL and \"COL 87\" IS NULL and \"COL 88\" IS NULL and \"COL 89\" IS NULL and \"COL 90\" IS NULL and \"COL 91\" IS NULL and \"COL 92\" IS NULL and \"COL 93\" IS NULL and \"COL 94\" IS NULL and \"COL 95\" IS NULL and \"COL 96\" IS NULL and \"COL 97\" IS NULL and \"COL 98\" IS NULL and \"COL 99\" IS NULL and \"COL 100\" IS NULL and \"COL 101\" IS NULL and \"COL 102\" IS NULL and \"COL 103\" IS NULL and \"COL 104\" IS NULL and \"COL 105\" IS NULL and \"COL 106\" IS NULL and \"COL 107\" IS NULL and \"COL 108\" IS NULL and \"COL 109\" IS NULL and \"COL 110\" IS NULL and \"COL 111\" IS NULL and \"COL 112\" IS NULL and \"COL 113\" IS NULL and \"COL 114\" IS NULL and \"COL 115\" IS NULL and \"COL 116\" IS NULL and \"COL 117\" IS NULL and \"COL 118\" IS NULL and \"COL 119\" = HEXTORAW('c3023d02') and \"COL 120\" IS NULL and \"COL 121\" IS NULL and \"COL 122\" IS NULL and \"COL 123\" IS NULL and \"COL 124\" IS NULL and \"COL 125\" IS NULL and \"COL 126\" = HEXTORAW('4e4557') and \"COL 127\" IS NULL and \"COL 128\" IS NULL and \"COL 129\" IS NULL and \"COL 130\" IS NULL and \"COL 131\" IS NULL and \"COL 132\" IS NULL and \"COL 133\" IS NULL and \"COL 134\" IS NULL and \"COL 135\" IS NULL and \"COL 136\" IS NULL and \"COL 137\" IS NULL and \"COL 138\" IS NULL and \"COL 139\" IS NULL and \"COL 140\" IS NULL and \"COL 141\" IS NULL and \"COL 142\" IS NULL and \"COL 143\" IS NULL and \"COL 144\" = HEXTORAW('c103') and \"COL 145\" IS NULL and \"COL 146\" = HEXTORAW('c2083e') and \"COL 147\" = HEXTORAW('c103') and \"COL 148\" = HEXTORAW('c2083e') and \"COL 149\" = HEXTORAW('c103') and \"COL 150\" = HEXTORAW('c2083e') and \"COL 151\" = HEXTORAW('c103') and \"COL 152" +
					"\" = HEXTORAW('c2083e') and \"COL 153\" = HEXTORAW('c103') and \"COL 154\" IS NULL and \"COL 155\" IS NULL and \"COL 156\" IS NULL and \"COL 157\" IS NULL and \"COL 158\" IS NULL and \"COL 159\" = HEXTORAW('c102') and \"COL 160\" IS NULL and \"COL 161\" IS NULL and \"COL 162\" IS NULL and \"COL 163\" IS NULL and \"COL 164\" IS NULL and \"COL 165\" IS NULL and \"COL 166\" IS NULL and \"COL 167\" IS NULL and \"COL 168\" IS NULL and \"COL 169\" IS NULL and \"COL 170\" IS NULL and \"COL 171\" IS NULL and \"COL 172\" IS NULL and \"COL 173\" = HEXTORAW('80') and \"COL 174\" IS NULL";
			assertTrue(compareLogMinerText(lmUpd2, stmt.getSqlRedo()));

			assertTrue(transaction.getStatement(stmt));
			assertEquals(stmt.getOperation(), UPDATE);
			assertEquals(stmt.getRba(), rrUpdate1.rba());
			assertEquals(stmt.getScn(), rrUpdate1.scn());
			assertEquals(stmt.getRowId().toString(), "AAAqUAAAjAAPd8eAAA");
			System.out.println(stmt);
			final String lmUpd3 =
					"update \"UNKNOWN\".\"OBJ# 173312\" set \"COL 7\" = HEXTORAW('c5022f4e5053'), \"COL 8\" = HEXTORAW('c20803'), \"COL 9\" = HEXTORAW('c3042623'), \"COL 10\" = HEXTORAW('787e01140b2b23'), \"COL 33\" = NULL, \"COL 34\" = NULL, \"COL 36\" = HEXTORAW('c2034c'), \"COL 105\" = NULL, \"COL 106\" = NULL where \"COL 1\" = HEXTORAW('c504054d3530') and \"COL 2\" = HEXTORAW('787e01140b2b20') and \"COL 3\" = HEXTORAW('80') and \"COL 4\" = HEXTORAW('787e01140b2a04') and \"COL 5\" = HEXTORAW('c2154f') and \"COL 6\" = HEXTORAW('c5022b2c080a') and \"COL 7\" = HEXTORAW('c5022f4e501d') and \"COL 8\" = HEXTORAW('c20803') and \"COL 9\" = HEXTORAW('c3042622') and \"COL 10\" = HEXTORAW('787e01140b2b20') and \"COL 11\" = HEXTORAW('c4040e463d') and \"COL 12\" IS NULL and \"COL 13\" = HEXTORAW('c2083e') and \"COL 14\" = HEXTORAW('435049') and \"COL 15\" = HEXTORAW('c3163624') and \"COL 16\" = HEXTORAW('c113') and \"COL 17\" = HEXTORAW('c11c') and \"COL 18\" = HEXTORAW('c102') and \"COL 19\" = HEXTORAW('c41203091c') and \"COL 20\" IS NULL and \"COL 21\" = HEXTORAW('c2021744') and \"COL 22\" = HEXTORAW('4b47') and \"COL 23\" = HEXTORAW('c2021744') and \"COL 24\" = HEXTORAW('787e01140b2a03') and \"COL 25\" = HEXTORAW('c21f434c') and \"COL 26\" = HEXTORAW('c31e2941') and \"COL 27\" IS NULL and \"COL 28\" IS NULL and \"COL 29\" = HEXTORAW('c4032b5e07') and \"COL 30\" IS NULL and \"COL 31\" IS NULL and \"COL 32\" = HEXTORAW('c40f1e2f15') and \"COL 33\" = HEXTORAW('4e') and \"COL 34\" = HEXTORAW('c504054d3760') and \"COL 35\" IS NULL and \"COL 36\" = HEXTORAW('c204') and \"COL 37\" = HEXTORAW('c204') and \"COL 38\" = HEXTORAW('c2034c') and \"COL 39\" = HEXTORAW('c2034c') and \"COL 40\" = HEXTORAW('555344') and \"COL 41\" = HEXTORAW('c102') and \"COL 42\" = HEXTORAW('30') and \"COL 43\" = HEXTORAW('787d081c010101') and \"COL 44\" IS NULL and \"COL 45\" = HEXTORAW('80') and \"COL 46\" IS NULL and \"COL 47\" IS NULL and \"COL 48\" IS NULL and \"COL 49\" IS NULL and \"COL 50\" IS NULL and \"COL 51\" IS NULL and \"COL 52\" IS NULL and \"COL 53\" IS NULL and \"COL 54\" IS NULL and \"COL 55\" IS NULL and \"COL 56\" IS NULL and \"COL 57\" IS NULL and \"COL 58\" IS NULL and \"COL 59\" = HEXTORAW('c504054d352e') and \"COL 60\" = HEXTORAW('c41a18010c') and \"COL 61\" IS NULL and \"COL 62\" IS NULL and \"COL 63\" IS NULL and \"COL 64\" = HEXTORAW('524356') and \"COL 65\" = HEXTORAW('c41a18010c') and \"COL 66\" IS NULL and \"COL 67\" IS NULL and \"COL 68\" IS NULL and \"COL 69\" IS NULL and \"COL 70\" IS NULL and \"COL 71\" IS NULL and \"COL 72\" IS NULL and \"COL 73\" IS NULL and \"COL 74\" IS NULL and \"COL 75\" IS NULL and \"COL 76\" IS NULL and \"COL 77\" IS NULL and \"COL 78\" IS NULL and \"COL 79\" IS NULL and \"COL 80\" IS NULL and \"COL 81\" IS NULL and \"COL 82\" IS NULL and \"COL 83\" IS NULL and \"COL 84\" IS NULL and \"COL 85\" IS NULL and \"COL 86\" IS NULL and \"COL 87\" IS NULL and \"COL 88\" IS NULL and \"COL 89\" IS NULL and \"COL 90\" IS NULL and \"COL 91\" IS NULL and \"COL 92\" IS NULL and \"COL 93\" IS NULL and \"COL 94\" IS NULL and \"COL 95\" IS NULL and \"COL 96\" IS NULL and \"COL 97\" IS NULL and \"COL 98\" IS NULL and \"COL 99\" IS NULL and \"COL 100\" IS NULL and \"COL 101\" IS NULL and \"COL 102\" IS NULL and \"COL 103\" IS NULL and \"COL 104\" IS NULL and \"COL 105\" IS NULL and \"COL 106\" IS NULL and \"COL 107\" IS NULL and \"COL 108\" IS NULL and \"COL 109\" IS NULL and \"COL 110\" IS NULL and \"COL 111\" IS NULL and \"COL 112\" IS NULL and \"COL 113\" IS NULL and \"COL 114\" IS NULL and \"COL 115\" IS NULL and \"COL 116\" IS NULL and \"COL 117\" IS NULL and \"COL 118\" IS NULL and \"COL 119\" = HEXTORAW('c3023d02') and \"COL 120\" IS NULL and \"COL 121\" IS NULL and \"COL 122\" IS NULL and \"COL 123\" IS NULL and \"COL 124\" IS NULL and \"COL 125\" IS NULL and \"COL 126\" = HEXTORAW('4e4557') and \"COL 127\" IS NULL and \"COL 128\" IS NULL and \"COL 129\" IS NULL and \"COL 130\" IS NULL and \"COL 131\" IS NULL and \"COL 132\" IS NULL and \"COL 133\" IS NULL and \"COL 134\" IS NULL and \"COL 135\" IS NULL and \"COL 136\" IS NULL and \"COL 137\" IS NULL and \"COL 138\" IS NULL and \"COL 139\" IS NULL and \"COL 140\" IS NULL and \"COL 141\" IS NULL and \"COL 142\" IS NULL and \"COL 143\" IS NULL and \"COL 144\" = HEXTORAW('c103') and \"COL 145\" IS N" +
					"ULL and \"COL 146\" = HEXTORAW('c2083e') and \"COL 147\" = HEXTORAW('c103') and \"COL 148\" = HEXTORAW('c2083e') and \"COL 149\" = HEXTORAW('c103') and \"COL 150\" = HEXTORAW('c2083e') and \"COL 151\" = HEXTORAW('c103') and \"COL 152\" = HEXTORAW('c2083e') and \"COL 153\" = HEXTORAW('c103') and \"COL 154\" IS NULL and \"COL 155\" IS NULL and \"COL 156\" IS NULL and \"COL 157\" IS NULL and \"COL 158\" IS NULL and \"COL 159\" = HEXTORAW('c102') and \"COL 160\" IS NULL and \"COL 161\" IS NULL and \"COL 162\" IS NULL and \"COL 163\" IS NULL and \"COL 164\" IS NULL and \"COL 165\" IS NULL and \"COL 166\" IS NULL and \"COL 167\" IS NULL and \"COL 168\" IS NULL and \"COL 169\" IS NULL and \"COL 170\" IS NULL and \"COL 171\" IS NULL and \"COL 172\" IS NULL and \"COL 173\" = HEXTORAW('80') and \"COL 174\" IS NULL";
			assertTrue(compareLogMinerText(lmUpd3, stmt.getSqlRedo()));

			assertFalse(transaction.getStatement(stmt));

		} catch(IOException | SQLException e) {}
	}

	@Test
	public void partialRollbackSupplementalLogData() {

		var orl = OraCdcRedoLog.getLinux19c();

		/*
		 * SCN:6108291830901, RBA:0x0044a4.006c74be.0070, OP:5.1 fb:----FL--, supp fb:-C--FL--, OP:11.5 fb:----FL--
		 */
		var baUpdate1 = hexToRaw("A004000001008E05759490320200003A07D7CD51000000000501D6005D00FFFFD5604417759490328E0500000100FFFF0300000000000000CE001400180020001D000C000500060007000100040003001C00B000B000040003000700040007000300000012000000000002000400000007000300020005000200050000000000000000000300030001000000000000000000000000000000000000000000000000000000000000000000000001000100000000000000090000000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000001000500010001000400020002000200000000008003BE0C2200000063000D00B45E2A00A2D82B12D8A40200D8A402000B000000000000000B010D2A0000B45E040D00000000000021001A003A053000A3904203056910008E8500809F0C883271C10206F21EC0057D092501080000000C00010001005D06FCFF0000001C00004E0050005200540055005600C40A646464050100C40A64545F3DC408C664646464605000800092A0C2110529C2051500014C580017004F004F0000000010000000000000E0E74106080000000100020003000400050006000700080009000A000B000C000D000E000F0010001100120013001400150016001700180019001A001B001C001D001E001F0020002100220023002400250026002700280029002A002B002C002D002E002F0030003100320033003400350036003700380039003A003B003C003D003E003F0040004100420043004400450046004700480049004A004B004C004D004E00500052005400580059005A005B005C005D005E00040003000700040007000300FFFF1200FFFFFFFF02000400FFFF070003000200050002000500FFFFFFFFFFFFFFFF030003000100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF01000100FFFFFFFFFFFF0900FFFF0600FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0200FFFFFFFF01000500010001000400020002000200FFFFC3193B4AC20A2A00787E011E0E393303C3022C28787D0C0F0C2D07FF3E6466004647204F76657273746F636B205261636B731400C104A803C302601EC664646464646400474F53684C420200C40A64646400000045410000C40A646464006ECA3033350030333100364B42034E4B3D005991C4084744432D505A2030330000003235303235380B01C11500008049C002C402155D610600004E1C00004E000400C302601EC1020000C1020000C10201000B0501002500020071C10206C79290328E0500000102D8A40300000000000000140046001D000C00050006000700050004000300110D00000000000063000D00B45E2A00D5604417A2D82B00000000000000000000000000000000000000000002010D007594903200808E0507060080C79290328E0500000000140071C10206F21EC0057D090501080000000C08010001005D0604000000000014004E0050005200540055005600C40B0A6463000000C40A64445B152F00C6646464645C3C003C5C020266000000C2210951C209293E");
		var rrUpdate1 = new OraCdcRedoRecord(orl, 0x0000058e2476d2f6l, "0x0044a4.006c74be.0070", baUpdate1);
		assertTrue(rrUpdate1.has5_1());
		assertTrue(rrUpdate1.change5_1().supplementalLogData());
		assertTrue(rrUpdate1.change5_1().supplementalFb() != 0);
		assertTrue(rrUpdate1.change5_1().fb() != 0);
		assertFalse(rrUpdate1.has10_x());
		assertTrue(rrUpdate1.has11_x());
		assertEquals(rrUpdate1.change11_x().operation, _11_5_URP);
		assertTrue(rrUpdate1.change11_x().fb() != 0);

		/*
		 * SCN:6108291830908, RBA:0x0044a4.006c74e5.0064, OP:5.6 fb:--------, OP:11.5 fb:----FL--
		 */
		var baUpdate2 = hexToRaw("EC03000001008E057C9490321700000007D7CD51000006060B0501002500020071C10206759490328E0500000100D8A40300000000000000CA0020001D000C000500060007000100040003001C00B000B00004000300070004000700030000001200000000000200040000000700030002000500020005000000000000000000030003000100000000000000000000000000000000000000000000000000000000000000000000000100010000000000000009000000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000100050001000100040002000200020000000000040D00000000000021001A003A053000A3904203056910008E8500809F0C883271C10206F21EC0057D092502080000000C00010001005D06FCFF000000000E004E0050005200540055005600C40A646464000000C40A64545F3D0E39C66464646460500080000000C2110529C2051500014C580017004F004F0000000010000000000000E0E74106080000000100020003000400050006000700080009000A000B000C000D000E000F0010001100120013001400150016001700180019001A001B001C001D001E001F0020002100220023002400250026002700280029002A002B002C002D002E002F0030003100320033003400350036003700380039003A003B003C003D003E003F0040004100420043004400450046004700480049004A004B004C004D004E00500052005400580059005A005B005C005D005E00040003000700040007000300FFFF1200FFFFFFFF02000400FFFF070003000200050002000500FFFFFFFFFFFFFFFF030003000100FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF01000100FFFFFFFFFFFF0900FFFF0600FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF0200FFFFFFFF01000500010001000400020002000200FFFFC3193B4AC20A2A00787E011E0E393300C3022C28787D0C0F0C2D07033E6466004647204F76657273746F636B205261636B730000C1040B01C302601EC664646464646400474F53054C420000C40A646464058F3245410001C40A64646400FFFF30333500303331FF364B42034E058F32590500004744432D505A2030330000003235303235381000C115020080001400C402155D610000004E000E004ECA2F00C302601EC1020200C1020200C10200000506D6005D00FFFFD56044177C9490328E0500001600FFFF030000000000000006001C0008000000D8A40200D8A402000B000000000000000B010D2A1000B45E040D0000A409903202000000");
		var rrUpdate2 = new OraCdcRedoRecord(orl, 0x0000058e3290947cl, "0x0044a4.006c74e5.0064", baUpdate2);
		assertTrue(rrUpdate2.hasPrb());
		assertFalse(rrUpdate2.has5_1());
		assertFalse(rrUpdate2.has10_x());
		assertTrue(rrUpdate2.has11_x());
		assertEquals(rrUpdate2.change11_x().operation, _11_5_URP);
		assertTrue(rrUpdate2.change11_x().fb() != 0);

		assertNotEquals(rrUpdate1.halfDoneKey(), rrUpdate2.halfDoneKey());

		var raw = new OraCdcRawTransaction(new Xid((short)0x63, (short)0xd, 0x2a5eb4), ZoneId.systemDefault(), 0x10, new OraCdcLobExtras());
		try {
			raw.add(rrUpdate1, (int)(System.currentTimeMillis() / 1000));
			raw.add(rrUpdate2, (int)(System.currentTimeMillis() / 1000));
			raw.commitScn(0x0000058e3290947el);
			var transaction = new OraCdcTransactionArrayList(raw, orl.cdb(), REDOMINER, Path.of(System.getProperty("java.io.tmpdir")));
			var stmt = new OraCdcRedoMinerStatement();

			assertTrue(transaction.completed());

			assertFalse(transaction.getStatement(stmt));

		} catch(IOException | SQLException e) {}
	}


}
