/**
 * Copyright (c) 2018-present, A2 Re≈°itve d.o.o.
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in
 * compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License is
 * distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See
 * the License for the specific language governing permissions and limitations under the License.
 */

package solutions.a2.cdc.oracle.internals;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertFalse;
import static org.junit.jupiter.api.Assertions.assertTrue;
import static solutions.a2.cdc.oracle.OraCdcTransaction.LobProcessingStatus.REDOMINER;
import static solutions.a2.cdc.oracle.OraCdcV$LogmnrContents.INSERT;
import static solutions.a2.cdc.oracle.internals.OraCdcChange._11_2_IRP;
import static solutions.a2.cdc.oracle.internals.OraCdcChange._11_3_DRP;
import static solutions.a2.oracle.utils.BinaryUtils.hexToRaw;

import java.io.IOException;
import java.nio.file.Path;
import java.sql.SQLException;
import java.time.ZoneId;

import org.junit.jupiter.api.Test;

import solutions.a2.cdc.oracle.OraCdcLobExtras;
import solutions.a2.cdc.oracle.OraCdcRawTransaction;
import solutions.a2.cdc.oracle.OraCdcRedoMinerStatement;
import solutions.a2.cdc.oracle.OraCdcTransactionArrayList;
import solutions.a2.oracle.internals.Xid;

/**
 *  
 * @author <a href="mailto:averemee@a2.solutions">Aleksei Veremeev</a>
 * 
 */
public class Op11_2_Test extends TestWithOutput {

	@Test
	public void singleRedoRecord() {

		var orl = OraCdcRedoLog.getLinux19c();

		var baInsert1 = hexToRaw("980200000500000099E2DC03010000003A00ADD1000000000000010003000000030000000A00000098E2DC030000000097E2DC03000000009CE2DC0300000000FF6D9C4805021D000B00FFFFE000400247E0DC03000000000100FFFF0300000000000000060020000400000012000000EE0C0000340A400219040A005200880000FF000000000000000000003A00ADD105011E000B00FFFF340A400246E0DC03000000000300FFFF03000000000000000C0014004C000800140014008800F8191200000007001200EE0C000019040A00412701004127010005000000000000000B011200080C010000000000340A4002190407008B13DB03000000009613DB030000000001000000FFFFFFFFFFFFFFFF300A40020000000000000000030D000000000000DB000003DA000003FA1223010100000000000000021C0000010000000100000000000000000200000B0201000C000100DB00000360353C0100000000020041270300000000000000160018003100030004000800030007000300020002000000010D00000000000007001200EE0C0000340A400219040A00DB000003DA000003FA120201010000002C01080000000000000000000000000000000000000000002B0000000000000000000000C24C16005741524453414C45534D414EC24D630077B5021601010100C20D3300C2060000C11F000005130000000000000000000000000000000000000006000003000000000000002000080003000300000006000C0005000300200000000600040004000000000000006A62E800000053595300535953006F7261636C6500003932326264343936653439317074732F300000003732330073716C706C7573403932326264343936653439312028544E532056312D563329000001000000000000000013FFFFFFFF");
		var rrInsert1 = new OraCdcRedoRecord(orl, 0x0000000003dce299l, "0x000363.00001224.0010", baInsert1);
		assertTrue(rrInsert1.has5_1());
		assertTrue(rrInsert1.change5_1().supplementalLogData());
		assertTrue(rrInsert1.change5_1().supplementalFb() != 0);
		assertTrue(rrInsert1.change5_1().fb() == 0);
		assertFalse(rrInsert1.has10_x());
		assertTrue(rrInsert1.has11_x());
		assertTrue(rrInsert1.change11_x().fb() != 0);
		assertFalse(rrInsert1.change11_x().compressed());
		assertEquals(rrInsert1.change11_x().operation, _11_2_IRP);

		var raw = new OraCdcRawTransaction(new Xid((short)7, (short)0x12, 0xcee), ZoneId.systemDefault(), 0x10, new OraCdcLobExtras());
		try {
			raw.add(rrInsert1, (int)(System.currentTimeMillis() / 1000));
			raw.commitScn(0x0000000003da258al);
			var transaction = new OraCdcTransactionArrayList(raw, orl.cdb(), REDOMINER, Path.of(System.getProperty("java.io.tmpdir")));
			var stmt = new OraCdcRedoMinerStatement();

			assertTrue(transaction.completed());

			assertTrue(transaction.getStatement(stmt));
			assertEquals(stmt.getOperation(), INSERT);
			assertEquals(stmt.getRba(), rrInsert1.rba());
			assertEquals(stmt.getRowId().toString(), "AAASdBAAMAAAADbAAA");
			System.out.println(stmt);

		} catch(IOException | SQLException e) {}
	}

	@Test
	public void testRaInterfaceLinesAll_Reverse() {

		var orl = OraCdcRedoLog.getLinux19c();

		var baInsert1 = hexToRaw("0C04000001008D05AD2F4AF30300000007D7CD51000000000501FE005600FFFFD0C980154B2C4AF38D0500000600FFFF03000000000000000C0014001800200014001C007400BE0422000000770020006C991B00370643001F9B02001F9B020007000000000000000B01204200006C99040D491766C423003B000B000B64380019778D152D8316008D8500808A024FF1998D00043203C0037D09230102000000000000B602080000090000005C0000000000010000000000998D00040000008B0B0201001A000200998D0004AD2F4AF38D05000001001F9B03000000000000000402180050000A000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000030001001E001E001E0000000500000000000000000000000100000000000000000001000700010007000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020007000500010D000000000000770020006C991B00D0C9801537064300998D00043203C0037D090201020000000402FF00FF7F000000D080220000000000000000000000009A010000007EFFFFFFFFFFFFFFFFFFFFFFFDFF0FFA1EEEFFFFFFFFFFFFBFFFFFFFFFFFFF0F002100343930303238363130320000C4082E150300000043410000323631003000000020202020202020202020202020202020202020202020202020202020203100002020202020202020202020202020202020202020202020202020202020300000202020202020202020202020202020202020202020202020202020202030000035333938330000005300000080000000787D0C100B393B0080000000787D0C100B393B00C1540000C2033E00C1020000787D0C0811153900C41B21275B000000");
		var rrInsert1 = new OraCdcRedoRecord(orl, 0x0000058df34a2fadl, "0x00434e.00f8af9d.011c", baInsert1);
		assertTrue(rrInsert1.has5_1());
		assertTrue(rrInsert1.change5_1().supplementalLogData());
		assertTrue(rrInsert1.change5_1().supplementalFb() != 0);
		assertTrue(rrInsert1.change5_1().fb() == 0);
		assertFalse(rrInsert1.has10_x());
		assertTrue(rrInsert1.has11_x());
		assertTrue(rrInsert1.change11_x().fb() != 0);
		assertFalse(rrInsert1.change11_x().compressed());
		assertEquals(rrInsert1.change11_x().operation, _11_2_IRP);

		var baInsert2 = hexToRaw("0803000001008D05AD2F4AF30400000007D7CD51000000000501FE005600FFFFD0C98015AD2F4AF38D0500000100FFFF03000000000000000C0014001800100014001C006400480422000000770020006C991B00370644001F9B02001F9B020007000000000000000B01204300006C99020D491766C42300D0C9801537064300998D00043203C0037D09230102000000010000B60204000009000000010000000000010000000000998D00040000008B0B0201001A000200998D0004AD2F4AF38D05000002001F9B0300000000000000BC0010003C0000000B00070012000800010001000800010006000F00030004003D0003000500000003000000040000000000040000000400000000000000040000000400000000000000040000000000000000000000000000000000000000000000040000000200000000000000000000000000030003000300030000000000000000000000000000000000000000000000000000000000000007000A0010000100000000000000000000000000000003000700010007000B000000020D000000000000D0C9801537064400998D00043203C0037D0902010200000028025B00FF7F000000D08022998D0004000000000000000068010100000100B5AEFBBF7EF8FFC31FFCFDFF0F4F5244455220454E5452590031373537323433004f52444552204f52444552204f524445522000003139383330393230300000003000000032363332333839303000000034343031323400004f52444552204f52444552204f524400C21516004C494E454f52444552204f52444552204f52444552204f52444552204f52444552204f52444552204f52444552204f52444552204f52444552204f52444552204f00000045555200C303083329000000C20B0A00C3024A02C3105B3EC3093545C3105B3EC30E1746C3105B3E55736572C1020000C2145100C2145100C10B3100C10B3100787D0C100B2803005348495020504F494E540000435553544F4D4552205049434B205550300000003E626600313735373234330031000000787D0C08010101004F5244455220454E54525900");
		var rrInsert2 = new OraCdcRedoRecord(orl, 0x0000058df34a2fadl, "0x00434e.00f8af9f.0148", baInsert2);
		assertTrue(rrInsert2.has5_1());
		assertTrue(rrInsert2.change5_1().supplementalLogData());
		assertTrue(rrInsert2.change5_1().supplementalFb() != 0);
		assertTrue(rrInsert2.change5_1().fb() == 0);
		assertFalse(rrInsert2.has10_x());
		assertTrue(rrInsert2.has11_x());
		assertTrue(rrInsert2.change11_x().fb() != 0);
		assertFalse(rrInsert2.change11_x().compressed());
		assertEquals(rrInsert2.change11_x().operation, _11_2_IRP);

		var raw = new OraCdcRawTransaction(new Xid((short)0x77, (short)0x20, 0x1b996c), ZoneId.systemDefault(), 0x10, new OraCdcLobExtras());
		try {
			raw.add(rrInsert1, (int)(System.currentTimeMillis() / 1000));
			raw.add(rrInsert2, (int)(System.currentTimeMillis() / 1000));
			raw.commitScn(0x0000058df34a31eel);
			var transaction = new OraCdcTransactionArrayList(raw, orl.cdb(), REDOMINER, Path.of(System.getProperty("java.io.tmpdir")));
			var stmt = new OraCdcRedoMinerStatement();

			assertTrue(transaction.completed());

			assertTrue(transaction.getStatement(stmt));
			assertEquals(stmt.getOperation(), INSERT);
			assertEquals(stmt.getRba(), rrInsert1.rba());
			assertEquals(stmt.getRowId().toString(), "AAApsfAAQAAAI2ZAAB");
			System.out.println(stmt);

		} catch(IOException | SQLException e) {}
	}

	@Test
	public void advancedCompressionSingle() {

		var orl = OraCdcRedoLog.getLinux19c();

		var baInsert1 = hexToRaw("F0020000059D000081A71C03010000002984184B000000000000010003000000030000000A00000080A71C03000000007FA71C030000000084A71C0300000000529ED64805021F000B00FFFFF0004002EBA51C03000000000100FFFF0300000000000000060020000400000018000000A00E0000D60F400258030D005200FC0000ABCE0C00000000000000002984184B050120000B00FFFFD60F4002EAA51C03000000000100FFFF03000000000000001E0014004C002000140014000E000E00030003000300070004000B0007000000FC00E2171200000008001800A00E000058030D9A8B270100B232010006000000000000000B011800080C010000000000D60F400258030C00A5A01C0300000000C5A01C0300000000F9ABCE0CFFFFFFFFFFFFFFFFD50F4002000000006E000000040D00000300FFFF020020005F0E0000EC064002FA030B00008000800BA61C039500400392004003FA12230902000000C8000100021C07000100000000000000000800000002000001000200030004000500060007000000030003000300070004000B0007000000C2030200C2030200C2030200616161616161610062626161787E010814142F38ACC6180076BE0414010101000B0201000D000100950040030FA61C03000000000100B23203000000000000000800500031003000110D00000000000008001800A00E0000D60F400258030D00000000000000000000000000000000000000000002020D0081A71C0300800000010600800EA61C03020600800BA61C0300000000000000009500400392004003FA120209020000002C02070001000000000000000000000000000000000000003000C800010000000000A0002C0007CF61616161616161CC62626161CF76BE0414010101D3787E010814142F38ACC618CBC20302CBC20302CBC2030205140000000000000000000000000000000000000006000003000000000000001200080000000600040004000000000003008B150000FBB13C0000000000010000005B9300000013E8ED00004344438C");
		var rrInsert1 = new OraCdcRedoRecord(orl, 0x00000000031ca60fl, "0x0001d2.0001b181.0010", baInsert1);
		assertTrue(rrInsert1.has5_1());
		assertTrue(rrInsert1.change5_1().supplementalLogData());
		assertTrue(rrInsert1.change5_1().supplementalFb() != 0);
		assertTrue(rrInsert1.change5_1().fb() == 0);
		assertFalse(rrInsert1.has10_x());
		assertTrue(rrInsert1.has11_x());
		assertTrue(rrInsert1.change11_x().fb() != 0);
		assertTrue(rrInsert1.change11_x().compressed());
		assertEquals(rrInsert1.change11_x().operation, _11_2_IRP);

		var raw = new OraCdcRawTransaction(new Xid((short)2, (short)0x20, 0xe5f), ZoneId.systemDefault(), 0x10, new OraCdcLobExtras());
		try {
			raw.add(rrInsert1, (int)(System.currentTimeMillis() / 1000));
			raw.commitScn(0x00000000031ca610l);
			var transaction = new OraCdcTransactionArrayList(raw, orl.cdb(), REDOMINER, Path.of(System.getProperty("java.io.tmpdir")));
			var stmt = new OraCdcRedoMinerStatement();

			assertTrue(transaction.completed());

			assertTrue(transaction.getStatement(stmt));
			assertEquals(stmt.getOperation(), INSERT);
			assertEquals(stmt.getRba(), rrInsert1.rba());
			assertEquals(stmt.getRowId().toString(), "AAATKyAANAAAACVADI");
			System.out.println(stmt);

		} catch(IOException | SQLException e) {}
	}

	@Test
	public void partialRollbackMtlSystemsItemsB() {

		var orl = OraCdcRedoLog.getLinux19c();

		/*
		 * SCN:6108345907885, RBA:0x0044ba.0028ab59.0010, OP:5.1 fb:--------, supp fb:----F---, OP:11.2 fb:-----L--
		 */
		var baInsert1 = hexToRaw("9405000005008E05ADBAC9350100000807D7CD5100000100000001000C0000000C0000000A050000ADBAC9358E050000ABBAC9358E050000B0BAC9358E0500006832F7480502F7001500FFFF38BB4203B5B9C9358E0500000100FFFF030000000000000006002000040000001F00000002AE240030864217A93529005200900000000000000000000000000007D7CD510501F8005D00FFFF30864217B4B9C9358E0500000400FFFF03000000000000000C0014004C00080014001C009000C6061200000074001F0002AE2400A9352900E5A40200E5A402000E000000000000000B011F00080C01000000000030864217A935240027B3C9358E0500003CB3C9358E05000000000000FFFFFFFFFFFFFFFF2E86421700000000EA000000030D4315916F35007F7F7B0842B4C4087D09230102000000020000740208000045000000940000000000EC65000000007F7F7B08020000000B0201002E0002007F7F7B085E69C9358E0500000100E5A40300000000000000040218005000080002000400040001000600020000000200000002000000010000000000000000000200000000000000000000000000020000000200000000000000000000000000010001000100000000000100000000000000000000000000010000000000000000000000000000000000010000000100010000000000000000000100000000000000010001000100010000000100020002000200000000000100010000000000000000000000000000000000000000000000000000000000000000000000000000000000020001000000000000000000020000000000000001000100010000000000000000000000000000000B00010000000000000000000100010002000100000001000100000000000000000000000000000000000200000001000100000000000000010000000000010008000100000000000000000000000000000000000000020001000100000000000000000000000000000000000000020002000200000002000000000000000000020002000200020002000000000000000000000000000000000000000000000000000000000000000000000000000100000000000100010000000000000001000100000001000000000001000100010000000000000000000100000000000000000001000200000002000000000000000000000000000000000000000000000000000000000000000000000001000900010D00000000000074001F0002AE240030864217A93529007F7F7B0842B4C4087D090201020000000402FF00FF7F0000F8D1C1ED000000000000000000000000970102000080EAFDFAB1DFBFBC4398FFFFE71D7F1EF22F37FEE33F7AF0FFBF398DF7F4FF1F0003004B494C4F4752414DC1042E00C3295D2FC3295D2E59000000414354495645062DC1076565C1030000C102000080001200C1022800C1038215C10213004E8500804EF4D1344E0501884E82400E4EFF4C0C590000005900B3824E3E64664E4306095908D3004E00180159020100500003004EFF4C0CC108C935C1030000C103E6C14E0000004E000000C102180059000D00C10310004E001A004E0006004E652600554E5055424C4953484544004E0002004E3E646659430609C11AD3004EC641175901000059FE8E05C102C9358000000180D7CD514E0000005901F000494E5445524E414C597BC935C10200005000FFFF50000000C1030000C1031400C1022000C1031400C103060CC1030000C1040600C1042600C1042F004EBD02004EBD02004E0000004E0000004E01062E59006565590D82155958130059001A00599731004E5E4517C1041C00C10300804E6EC93544454641554C544942122401051400000000000000000000000000000000000000065F55030000000000000012000800000006000400040000000600040049540000E319211700000000010000002D0000000013DACDCB1F434142524555260041505053");
		var rrInsert1 = new OraCdcRedoRecord(orl, 0x0000058e35c9baadl, "0x0044ba.0028ab59.0010", baInsert1);

		assertTrue(rrInsert1.has5_1());
		assertTrue(rrInsert1.change5_1().supplementalLogData());
		assertTrue(rrInsert1.change5_1().supplementalFb() != 0);
		assertTrue(rrInsert1.change5_1().fb() == 0);
		assertFalse(rrInsert1.has10_x());
		assertTrue(rrInsert1.has11_x());
		assertTrue(rrInsert1.change11_x().fb() != 0);
		assertFalse(rrInsert1.change11_x().compressed());
		assertEquals(rrInsert1.change11_x().operation, _11_2_IRP);

		/*
		 * SCN:6108345907885, RBA:0x0044ba.0028ab5b.01c4, OP:5.1 fb:--------, supp fb:-----L--, OP:11.2 fb:--H-F---
		 */
		var baInsert2 = hexToRaw("A803000001A38E05ADBAC9350200000107D7CD51000000090501F8005D00FFFF30864217ADBAC9358E0500000100FFFF03000000000000000C0014001800100014001C00640034062200000074001F0002AE2400A9352A00E5A40200E5A402000E000000000000000B011F29000002AE020D4315916F350030864217A93529007F7F7B0842B4C4087D09230102000000030000740204000045000000010000000000EC65000000007F7F7B08020000000B0201002E0002007F7F7B08ADBAC9358E0500000100E5A403000000000000002C011000430005000300070003000700030005000100010000000000180000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000C000300030000000200000000000000000000000000000000000000010001000100010001000100010001000100010001000100010001000100010002000300010001000000010001000700010001000100000000000100000000000000010000000000000007000100010001000000000007000200000000000000000002000200000002000000000000000000000004000000020000000000000000000200020000000000020000000200000000000000010001000100000002000000010001000000020001000100000001000100000000000000020000000200020DC8EC5D7F000030864217A9352A007F7F7B0842B4C4087D0902010200000028029300FF7F0000F8D1C1ED7F7F7B08020000000000000050010300000076FFFF1FFD070080C0EE304F5FCF3A4AE432FEE33F1EC4024D4D22000200C2033E00787E02020D190935C20E2817787E02020D190917C20E2800C4312F0350CC5B034E7BC935590500004f52444552204f52444552204f52444552204f5244455220524D303030333731524157204D4154455249414C4E2F41004E2F4100504CCD51590174005900FFFF59374303597BC9354E0500005900FFFF4E000000590000005900140059002CC059003A135900D1025900120059E2310059551D0059000000C1020000C20B03004E000000590712004E0C01004E0000005741524E494E47005954C9354E0500005957C9354E0500008047D33F5741524E494E47FF4E3743034E0000004E0000005741524E494E4700C1040000C1030000C1050000C1020000C3295D27C1030000C1030800C1020600C1050400C10208004E0000008000CC4480180000C1020100420041174E000013C105CB1F4E5953414E4D494E4E50505359000000C1048E054B47C935");
		var rrInsert2 = new OraCdcRedoRecord(orl, 0x0000058e35c9baadl, "0x0044ba.0028ab5b.01c4", baInsert2);

		assertTrue(rrInsert2.has5_1());
		assertTrue(rrInsert2.change5_1().supplementalLogData());
		assertTrue(rrInsert2.change5_1().supplementalFb() != 0);
		assertTrue(rrInsert2.change5_1().fb() == 0);
		assertFalse(rrInsert2.has10_x());
		assertTrue(rrInsert2.has11_x());
		assertTrue(rrInsert2.change11_x().fb() != 0);
		assertFalse(rrInsert2.change11_x().compressed());
		assertEquals(rrInsert2.change11_x().operation, _11_2_IRP);

		assertEquals(rrInsert1.halfDoneKey(), rrInsert2.halfDoneKey());

		/*
		 * SCN:6108345907888, RBA:0x0044ba.0028ab67.00f0, OP:5.6 fb:--------, supp fb:-----L--, OP:11.3 fb:--------
		 */
		var baDelete1 = hexToRaw("CC00000001208E05B0BAC9350700000007D7CD51000001000B0301002E0002007F7F7B08ADBAC9358E0500000200E5A403000000000000000800100014001C00020D4315916F350030864217A93529007F7F7B0842B4C4087D09230202000000030000740204000045000000010000000000EC65000000007F7F7B08020000000506F8005D00FFFF30864217B0BAC9358E0500000600FFFF030000000000000006001C0008000000E5A40200E5A402000E000000000000000B011F29100002AE020D43153406C93502000000");
		var rrDelete1 = new OraCdcRedoRecord(orl, 0x0000058e35c9bab0l, "0x0044ba.0028ab67.00f0", baDelete1);
		assertTrue(rrDelete1.hasPrb());
		assertFalse(rrDelete1.has5_1());
		assertFalse(rrDelete1.has10_x());
		assertTrue(rrDelete1.has11_x());
		assertEquals(rrDelete1.change11_x().operation, _11_3_DRP);
		assertTrue(rrDelete1.change11_x().fb() == 0);

		/*
		 * SCN:6108345907888, RBA:0x0044ba.0028ab67.01bc, OP:5.11 fb:--------, supp fb:----F---, OP:11.3 fb:--------
		 */
		var baDelete2 = hexToRaw("C400000001058E05B0BAC9350800000707D7CD51000000000B0301002E0002007F7F7B08B0BAC9358E0500000100E5A403000000000000000800080014001C00030D4315916F35007F7F7B0842B4C4087D09230202000000020000740208000045000000940000000000EC65000000007F7F7B0802000000050BF7001500FFFF38BB4203ADBAC9358E0500000100FFFF030000000000000006001C0008000000E5A40200E5A402000E000000000000000B011F00180C0100000000009806C93502000000");
		var rrDelete2 = new OraCdcRedoRecord(orl, 0x0000058e35c9bab0l, "0x0044ba.0028ab67.01bc", baDelete2);
		assertTrue(rrDelete2.hasPrb());
		assertFalse(rrDelete2.has5_1());
		assertFalse(rrDelete2.has10_x());
		assertTrue(rrDelete2.has11_x());
		assertEquals(rrDelete2.change11_x().operation, _11_3_DRP);
		assertTrue(rrDelete2.change11_x().fb() == 0);

		assertEquals(rrDelete1.halfDoneKey(), rrDelete2.halfDoneKey());

		var raw = new OraCdcRawTransaction(new Xid((short)74, (short)0x1f, 0x24ae02), ZoneId.systemDefault(), 0x10, new OraCdcLobExtras());
		try {
			raw.add(rrInsert1, (int)(System.currentTimeMillis() / 1000));
			raw.add(rrInsert2, (int)(System.currentTimeMillis() / 1000));
			raw.add(rrDelete1, (int)(System.currentTimeMillis() / 1000));
			raw.add(rrDelete2, (int)(System.currentTimeMillis() / 1000));
			raw.commitScn(0x0000058e35c9f0f6l);
			var transaction = new OraCdcTransactionArrayList(raw, orl.cdb(), REDOMINER, Path.of(System.getProperty("java.io.tmpdir")));
			var stmt = new OraCdcRedoMinerStatement();

			assertTrue(transaction.completed());

			assertFalse(transaction.getStatement(stmt));

		} catch(IOException | SQLException e) {}
	}

}
